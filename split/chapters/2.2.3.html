<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!-- Global site tag (gtag.js) - Google Analytics - START -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-156801664-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-156801664-1');
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics - END -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="description" content="2.2.3&nbsp;&nbsp;
    Sequences as Conventional Interfaces
  " />
    <title>
      2.2.3&nbsp;&nbsp;
    Sequences as Conventional Interfaces
  
    </title>
    
  <meta name="csrf-param" content="authenticity_token" />
  <meta name="csrf-token" content="EMTEijVc2kiiKUH4nYH0lQG3pLPfMowQ/Stg//t6DCo0e5pWMQwamnTvIdmVZqY/MqSx2IYYE+2bpNV6UNSMwQ==" />

    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata&display?swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Droid+Sans|Droid+Serif" rel="stylesheet">
    <link rel="stylesheet" media="all" href="../assets/stylesheet.css" />

   <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon.ico" />

<!--    <link rel="shortcut icon" type="image/png" href="../images/lambda.png" /> -->

    <!-- for support of progressive web app, see github README, DISABLED!
    <link rel="manifest" href="../static/manifest.json">
    -->

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" 
		     	  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
	          crossorigin="anonymous">
    </script> 

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

    <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script> -->
    <script type="text/javascript" 
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-AMS-MML_HTMLorMML-full">
    </script>
   <!--  <script type="text/javascript" 
      src="../MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full">
    </script> -->
  
    <script src="../assets/application.js"></script>
  
    <!-- Rendering inline LaTeX -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true,
          jax: ["input/TeX","output/HTML-CSS"]
        }
      });
    </script>
    <!--<script src="/mathjax/MathJax.js?config=TeX-AMS_HTML-full.js" type="text/javascript"></script>-->
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js" type="text/javascript"></script>
    <![endif]-->
  </head>
  <body>

    
    <!-- support for progressive web app, see README, DISABLED
    <script>
      if ('serviceWorker' in navigator && !navigator.serviceWorker.controller) {
          navigator.serviceWorker.register("../sw.js").then(function(reg) {
              console.log("Service worker has been registered for scope: " + reg.scope);
          });
      }
    </script>
    -->

     <nav class="navbar navbar-expand-sm navbar-dark bg-dark fixed-top justify-content-between">
       <button id="btn" class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#nav-sidebar" aria-controls="nav-sidebar" aria-expanded="false" aria-label="Toggle navigation" title="navigation">
         <span class="navbar-toggler-icon"></span>
       </button>
       <span class="navbar-brand-short"><a title="Go back to front page" href="../index.html" class="gray">SICP &mdash; Scheme/JS</a></span>
       <span class="navbar-brand-long" ><a title="Go back to front page" href="../index.html" class="gray">Structure and Interpretation of Computer Programs &mdash; Comparison Edition</a></span>

       <!-- edit the search engine by visiting: 
	    https://cse.google.com/cse/setup/basic?cx=015760785273492757659:nc_tznrzlsg 
	       -->
       <form class="form-inline ml-auto" id="xxx">
         <div id="search-box">
	         <script>
	           (function() {
	               var cx = "015760785273492757659:nc_tznrzlsg";
	               var gcse = document.createElement("script");
	               gcse.type = "text/javascript";
	               gcse.async = true;
	               gcse.src = "https://cse.google.com/cse.js?cx=" + cx;
	               var s = document.getElementsByTagName("script")[0];
	               s.parentNode.insertBefore(gcse, s);
	           })();
	           window.onload = function()
	           { 
	               var searchBox =  document.getElementById("gsc-i-id1");
	               searchBox.placeholder= "search web edition";
	               searchBox.title= "search web edition";
	           }
	         </script>
	         <gcse:search></gcse:search>
         </div>
       </form>
       <span class="navbar-brand-short">
         &nbsp;
         &nbsp;
         <a href="https://source-academy.github.io/source/" title="Go to the Source language(s) definition(s)" class="gray">S</a>
       </span>
       <span class="navbar-brand-long">
         &nbsp;
         &nbsp;
         <a href="https://source-academy.github.io/source/" title="Go to the Source language(s) definition(s)" class="gray">Source</a>
       </span>
     </nav>
     
     <div class="container scroll">

            
        <div class="collapse" id="nav-sidebar" role="tablist" aria-multiselectable="true">
        <!-- insert a dummy entry, to give one extra line of space -->
        <a class="navbar-brand" href="index.html">&nbsp;</a>
    
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-1">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-1" aria-expanded="false" aria-controls="sidebar-collapse-1">
                <a href="./foreword.html"> 
        Foreword
    </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-2">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-2" aria-expanded="false" aria-controls="sidebar-collapse-2">
                <a href="./prefaces.html"> 
        Prefaces
    </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-3">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-3" aria-expanded="false" aria-controls="sidebar-collapse-3">
                <a href="./acknowledgements.html"> 
Acknowledgments
    </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-4">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-4" aria-expanded="false" aria-controls="sidebar-collapse-4">
                <a href="./see.html"> 
    Index Crossreferences (for proofreading)
  </a>
              </span>
            </h5>
          </div>
        </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-5">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-5" aria-expanded="true" aria-controls="sidebar-collapse-5">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-5" aria-expanded="true" aria-controls="sidebar-collapse-5">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.html">1 
    Building Abstractions with 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
  </a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-5" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-6">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-6" aria-expanded="true" aria-controls="sidebar-collapse-6">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-6" aria-expanded="true" aria-controls="sidebar-collapse-6">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.1.html">1.1 The Elements of Programming</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-6" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-7">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-7" aria-expanded="false" aria-controls="sidebar-collapse-7">
                <a href="./1.1.1.html"> 1.1.1 Expressions</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-8">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-8" aria-expanded="false" aria-controls="sidebar-collapse-8">
                <a href="./1.1.2.html"> 1.1.2 Naming and the Environment</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-9">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-9" aria-expanded="false" aria-controls="sidebar-collapse-9">
                <a href="./1.1.3.html"> 1.1.3 
    Evaluating
    
      <span style="color:green">Combinations</span>
      <span style="color:blue">Operator Combinations</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-10">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-10" aria-expanded="false" aria-controls="sidebar-collapse-10">
                <a href="./1.1.4.html"> 1.1.4 
    Compound <span style="color:green">Procedures</span>
    <span style="color:blue">Functions</span>
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-11">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-11" aria-expanded="false" aria-controls="sidebar-collapse-11">
                <a href="./1.1.5.html"> 1.1.5 
    The Substitution Model for 
    
      <span style="color:green">
        Procedure
      </span>
      <span style="color:blue">
        Function
      </span>
    
    Application
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-12">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-12" aria-expanded="false" aria-controls="sidebar-collapse-12">
                <a href="./1.1.6.html"> 1.1.6 
    Conditional Expressions and Predicates
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-13">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-13" aria-expanded="false" aria-controls="sidebar-collapse-13">
                <a href="./1.1.7.html"> 1.1.7 Example: Square Roots by Newton's Method</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-14">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-14" aria-expanded="false" aria-controls="sidebar-collapse-14">
                <a href="./1.1.8.html"> 1.1.8 
    
      <span style="color:green">
        Procedures
      </span>
      <span style="color:blue">
        Functions
      </span>
    
    as Black-Box Abstractions
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-15">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-15" aria-expanded="true" aria-controls="sidebar-collapse-15">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-15" aria-expanded="true" aria-controls="sidebar-collapse-15">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.2.html">1.2 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
    and the Processes They Generate
  </a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-15" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-16">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-16" aria-expanded="false" aria-controls="sidebar-collapse-16">
                <a href="./1.2.1.html"> 1.2.1 Linear Recursion and Iteration</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-17">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-17" aria-expanded="false" aria-controls="sidebar-collapse-17">
                <a href="./1.2.2.html"> 1.2.2 Tree Recursion</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-18">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-18" aria-expanded="false" aria-controls="sidebar-collapse-18">
                <a href="./1.2.3.html"> 1.2.3 Orders of Growth</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-19">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-19" aria-expanded="false" aria-controls="sidebar-collapse-19">
                <a href="./1.2.4.html"> 1.2.4 Exponentiation</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-20">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-20" aria-expanded="false" aria-controls="sidebar-collapse-20">
                <a href="./1.2.5.html"> 1.2.5 Greatest Common Divisors</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-21">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-21" aria-expanded="false" aria-controls="sidebar-collapse-21">
                <a href="./1.2.6.html"> 1.2.6 Example: Testing for Primality</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-22">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-22" aria-expanded="true" aria-controls="sidebar-collapse-22">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-22" aria-expanded="true" aria-controls="sidebar-collapse-22">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.3.html">1.3 
        Formulating Abstractions with Higher-Order 
        
	  <span style="color:green">Procedures</span>
	  <span style="color:blue">Functions</span>
	
      </a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-22" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-23">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-23" aria-expanded="false" aria-controls="sidebar-collapse-23">
                <a href="./1.3.1.html"> 1.3.1 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
    as Arguments
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-24">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-24" aria-expanded="false" aria-controls="sidebar-collapse-24">
                <a href="./1.3.2.html"> 1.3.2 
    
      <span style="color:green">Constructing Procedures using Lambda</span>
      <span style="color:blue">Constructing Functions using Lambda Expressions
      </span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-25">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-25" aria-expanded="false" aria-controls="sidebar-collapse-25">
                <a href="./1.3.3.html"> 1.3.3 
    
      <span style="color:green">Procedures</span>
    <span style="color:blue">Functions</span>
    as General Methods
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-26">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-26" aria-expanded="false" aria-controls="sidebar-collapse-26">
                <a href="./1.3.4.html"> 1.3.4 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
    as Returned Values
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-27">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-27" aria-expanded="true" aria-controls="sidebar-collapse-27">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-27" aria-expanded="true" aria-controls="sidebar-collapse-27">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.html">2 Building Abstractions with Data</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-27" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-28">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-28" aria-expanded="true" aria-controls="sidebar-collapse-28">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-28" aria-expanded="true" aria-controls="sidebar-collapse-28">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.1.html">2.1 Introduction to Data Abstraction</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-28" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-29">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-29" aria-expanded="false" aria-controls="sidebar-collapse-29">
                <a href="./2.1.1.html"> 2.1.1 
    Example: Arithmetic Operations for Rational Numbers
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-30">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-30" aria-expanded="false" aria-controls="sidebar-collapse-30">
                <a href="./2.1.2.html"> 2.1.2 
    Abstraction Barriers
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-31">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-31" aria-expanded="false" aria-controls="sidebar-collapse-31">
                <a href="./2.1.3.html"> 2.1.3 
    What Is Meant by Data?
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-32">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-32" aria-expanded="false" aria-controls="sidebar-collapse-32">
                <a href="./2.1.4.html"> 2.1.4 
    Extended Exercise: Interval Arithmetic
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-33">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-33" aria-expanded="true" aria-controls="sidebar-collapse-33">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-33" aria-expanded="true" aria-controls="sidebar-collapse-33">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.2.html">2.2 Hierarchical Data and the Closure Property</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-33" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-34">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-34" aria-expanded="false" aria-controls="sidebar-collapse-34">
                <a href="./2.2.1.html"> 2.2.1 
    Representing Sequences
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-35">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-35" aria-expanded="false" aria-controls="sidebar-collapse-35">
                <a href="./2.2.2.html"> 2.2.2 
    Hierarchical Structures
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-36">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-36" aria-expanded="false" aria-controls="sidebar-collapse-36">
                <a href="./2.2.3.html"> 2.2.3 
    Sequences as Conventional Interfaces
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-37">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-37" aria-expanded="false" aria-controls="sidebar-collapse-37">
                <a href="./2.2.4.html"> 2.2.4 
    Example: A Picture Language
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-38">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-38" aria-expanded="true" aria-controls="sidebar-collapse-38">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-38" aria-expanded="true" aria-controls="sidebar-collapse-38">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.3.html">2.3 Symbolic Data</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-38" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-39">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-39" aria-expanded="false" aria-controls="sidebar-collapse-39">
                <a href="./2.3.1.html"> 2.3.1 
    
      <span style="color:green">Quotation</span>
      <span style="color:blue">Strings</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-40">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-40" aria-expanded="false" aria-controls="sidebar-collapse-40">
                <a href="./2.3.2.html"> 2.3.2 
    Example: Symbolic Differentiation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-41">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-41" aria-expanded="false" aria-controls="sidebar-collapse-41">
                <a href="./2.3.3.html"> 2.3.3 
    Example: Representing Sets
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-42">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-42" aria-expanded="false" aria-controls="sidebar-collapse-42">
                <a href="./2.3.4.html"> 2.3.4 
    Example: Huffman Encoding Trees
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-43">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-43" aria-expanded="true" aria-controls="sidebar-collapse-43">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-43" aria-expanded="true" aria-controls="sidebar-collapse-43">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.4.html">2.4 Multiple Representations for Abstract Data</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-43" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-44">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-44" aria-expanded="false" aria-controls="sidebar-collapse-44">
                <a href="./2.4.1.html"> 2.4.1 
    Representations for Complex Numbers
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-45">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-45" aria-expanded="false" aria-controls="sidebar-collapse-45">
                <a href="./2.4.2.html"> 2.4.2 
    Tagged data
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-46">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-46" aria-expanded="false" aria-controls="sidebar-collapse-46">
                <a href="./2.4.3.html"> 2.4.3 
    Data-Directed Programming and Additivity
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-47">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-47" aria-expanded="true" aria-controls="sidebar-collapse-47">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-47" aria-expanded="true" aria-controls="sidebar-collapse-47">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.5.html">2.5 Systems with Generic Operations</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-47" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-48">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-48" aria-expanded="false" aria-controls="sidebar-collapse-48">
                <a href="./2.5.1.html"> 2.5.1 
    Generic Arithmetic Operations
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-49">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-49" aria-expanded="false" aria-controls="sidebar-collapse-49">
                <a href="./2.5.2.html"> 2.5.2 
    Combining Data of Different Types
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-50">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-50" aria-expanded="false" aria-controls="sidebar-collapse-50">
                <a href="./2.5.3.html"> 2.5.3 
    Example: Symbolic Algebra
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-51">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-51" aria-expanded="true" aria-controls="sidebar-collapse-51">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-51" aria-expanded="true" aria-controls="sidebar-collapse-51">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.html">3 Modularity, Objects, and State</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-51" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-52">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-52" aria-expanded="true" aria-controls="sidebar-collapse-52">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-52" aria-expanded="true" aria-controls="sidebar-collapse-52">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.1.html">3.1 Assignment and Local State</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-52" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-53">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-53" aria-expanded="false" aria-controls="sidebar-collapse-53">
                <a href="./3.1.1.html"> 3.1.1 
    Local State Variables
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-54">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-54" aria-expanded="false" aria-controls="sidebar-collapse-54">
                <a href="./3.1.2.html"> 3.1.2 
    The Benefits of Introducing Assignment
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-55">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-55" aria-expanded="false" aria-controls="sidebar-collapse-55">
                <a href="./3.1.3.html"> 3.1.3 
    The Costs of Introducing Assignment
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-56">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-56" aria-expanded="true" aria-controls="sidebar-collapse-56">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-56" aria-expanded="true" aria-controls="sidebar-collapse-56">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.2.html">3.2 The Environment Model of Evaluation</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-56" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-57">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-57" aria-expanded="false" aria-controls="sidebar-collapse-57">
                <a href="./3.2.1.html"> 3.2.1 
    The Rules for Evaluation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-58">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-58" aria-expanded="false" aria-controls="sidebar-collapse-58">
                <a href="./3.2.2.html"> 3.2.2 
    Applying Simple
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-59">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-59" aria-expanded="false" aria-controls="sidebar-collapse-59">
                <a href="./3.2.3.html"> 3.2.3 
    Frames as the Repository of Local State
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-60">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-60" aria-expanded="false" aria-controls="sidebar-collapse-60">
                <a href="./3.2.4.html"> 3.2.4 
    Internal
    
      <span style="color:green">Definitions</span>
      <span style="color:blue">Declarations</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-61">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-61" aria-expanded="true" aria-controls="sidebar-collapse-61">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-61" aria-expanded="true" aria-controls="sidebar-collapse-61">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.3.html">3.3 Modeling with Mutable Data</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-61" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-62">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-62" aria-expanded="false" aria-controls="sidebar-collapse-62">
                <a href="./3.3.1.html"> 3.3.1 
    Mutable List Structure
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-63">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-63" aria-expanded="false" aria-controls="sidebar-collapse-63">
                <a href="./3.3.2.html"> 3.3.2 
    Representing Queues
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-64">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-64" aria-expanded="false" aria-controls="sidebar-collapse-64">
                <a href="./3.3.3.html"> 3.3.3 
    Representing Tables
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-65">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-65" aria-expanded="false" aria-controls="sidebar-collapse-65">
                <a href="./3.3.4.html"> 3.3.4 
    A Simulator for Digital Circuits
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-66">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-66" aria-expanded="false" aria-controls="sidebar-collapse-66">
                <a href="./3.3.5.html"> 3.3.5 
    Propagation of Constraints
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-67">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-67" aria-expanded="true" aria-controls="sidebar-collapse-67">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-67" aria-expanded="true" aria-controls="sidebar-collapse-67">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.4.html">3.4 Concurrency: Time Is of the Essence</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-67" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-68">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-68" aria-expanded="false" aria-controls="sidebar-collapse-68">
                <a href="./3.4.1.html"> 3.4.1 
    The Nature of Time in Concurrent Systems
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-69">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-69" aria-expanded="false" aria-controls="sidebar-collapse-69">
                <a href="./3.4.2.html"> 3.4.2 
    Mechanisms for Controlling Concurrency
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-70">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-70" aria-expanded="true" aria-controls="sidebar-collapse-70">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-70" aria-expanded="true" aria-controls="sidebar-collapse-70">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.5.html">3.5 Streams</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-70" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-71">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-71" aria-expanded="false" aria-controls="sidebar-collapse-71">
                <a href="./3.5.1.html"> 3.5.1 
    Streams Are Delayed Lists
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-72">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-72" aria-expanded="false" aria-controls="sidebar-collapse-72">
                <a href="./3.5.2.html"> 3.5.2 
    Infinite Streams
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-73">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-73" aria-expanded="false" aria-controls="sidebar-collapse-73">
                <a href="./3.5.3.html"> 3.5.3 
    Exploiting the Stream Paradigm
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-74">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-74" aria-expanded="false" aria-controls="sidebar-collapse-74">
                <a href="./3.5.4.html"> 3.5.4 
    Streams and Delayed Evaluation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-75">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-75" aria-expanded="false" aria-controls="sidebar-collapse-75">
                <a href="./3.5.5.html"> 3.5.5 
    Modularity of Functional Programs and Modularity of Objects
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-76">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-76" aria-expanded="true" aria-controls="sidebar-collapse-76">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-76" aria-expanded="true" aria-controls="sidebar-collapse-76">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.html">4 Metalinguistic Abstraction</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-76" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-77">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-77" aria-expanded="true" aria-controls="sidebar-collapse-77">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-77" aria-expanded="true" aria-controls="sidebar-collapse-77">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.1.html">4.1 The Metacircular Evaluator</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-77" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-78">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-78" aria-expanded="false" aria-controls="sidebar-collapse-78">
                <a href="./4.1.1.html"> 4.1.1 
    The Core of the Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-79">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-79" aria-expanded="false" aria-controls="sidebar-collapse-79">
                <a href="./4.1.2.html"> 4.1.2 
    Representing
    
      <span style="color:green">Expressions</span>
      <span style="color:blue">Components</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-80">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-80" aria-expanded="false" aria-controls="sidebar-collapse-80">
                <a href="./4.1.3.html"> 4.1.3 
    Evaluator Data Structures
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-81">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-81" aria-expanded="false" aria-controls="sidebar-collapse-81">
                <a href="./4.1.4.html"> 4.1.4 
    Running the Evaluator as a Program
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-82">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-82" aria-expanded="false" aria-controls="sidebar-collapse-82">
                <a href="./4.1.5.html"> 4.1.5 
    Data as Programs
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-83">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-83" aria-expanded="false" aria-controls="sidebar-collapse-83">
                <a href="./4.1.6.html"> 4.1.6 
    Internal
    
      <span style="color:green">Definitions</span>
      <span style="color:blue">Declarations</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-84">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-84" aria-expanded="false" aria-controls="sidebar-collapse-84">
                <a href="./4.1.7.html"> 4.1.7 
    Separating Syntactic Analysis from Execution
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-85">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-85" aria-expanded="true" aria-controls="sidebar-collapse-85">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-85" aria-expanded="true" aria-controls="sidebar-collapse-85">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.2.html">4.2 
    
      <span style="color:green">Variations on a Scheme:</span>
    
    Lazy Evaluation
</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-85" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-86">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-86" aria-expanded="false" aria-controls="sidebar-collapse-86">
                <a href="./4.2.1.html"> 4.2.1 
    Normal Order and Applicative Order
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-87">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-87" aria-expanded="false" aria-controls="sidebar-collapse-87">
                <a href="./4.2.2.html"> 4.2.2 
    An Interpreter with Lazy Evaluation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-88">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-88" aria-expanded="false" aria-controls="sidebar-collapse-88">
                <a href="./4.2.3.html"> 4.2.3 
    Streams as Lazy Lists
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-89">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-89" aria-expanded="true" aria-controls="sidebar-collapse-89">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-89" aria-expanded="true" aria-controls="sidebar-collapse-89">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.3.html">4.3 
    
      <span style="color:green">Variations on a Scheme:</span>
    
    Nondeterministic Computing
  </a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-89" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-90">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-90" aria-expanded="false" aria-controls="sidebar-collapse-90">
                <a href="./4.3.1.html"> 4.3.1 
    
      <span style="color:green">Amb and Search</span>
      <span style="color:blue">Search and amb</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-91">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-91" aria-expanded="false" aria-controls="sidebar-collapse-91">
                <a href="./4.3.2.html"> 4.3.2 
    Examples of Nondeterministic Programs
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-92">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-92" aria-expanded="false" aria-controls="sidebar-collapse-92">
                <a href="./4.3.3.html"> 4.3.3 
    Implementing the
    
      <span style="color:green">Amb</span>
      <span style="color:blue">amb</span>
    
    Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-93">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-93" aria-expanded="true" aria-controls="sidebar-collapse-93">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-93" aria-expanded="true" aria-controls="sidebar-collapse-93">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.4.html">4.4 Logic Programming</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-93" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-94">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-94" aria-expanded="false" aria-controls="sidebar-collapse-94">
                <a href="./4.4.1.html"> 4.4.1 
    Deductive Information Retrieval
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-95">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-95" aria-expanded="false" aria-controls="sidebar-collapse-95">
                <a href="./4.4.2.html"> 4.4.2 
    How the Query System Works
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-96">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-96" aria-expanded="false" aria-controls="sidebar-collapse-96">
                <a href="./4.4.3.html"> 4.4.3 
    Is Logic Programming Mathematical Logic?
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-97">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-97" aria-expanded="false" aria-controls="sidebar-collapse-97">
                <a href="./4.4.4.html"> 4.4.4 
    Implementing the Query System
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-98">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-98" aria-expanded="true" aria-controls="sidebar-collapse-98">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-98" aria-expanded="true" aria-controls="sidebar-collapse-98">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.html">5 Computing with Register Machines</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-98" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-99">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-99" aria-expanded="true" aria-controls="sidebar-collapse-99">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-99" aria-expanded="true" aria-controls="sidebar-collapse-99">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.1.html">5.1 Designing Register Machines</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-99" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-100">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-100" aria-expanded="false" aria-controls="sidebar-collapse-100">
                <a href="./5.1.1.html"> 5.1.1 
    A Language for Describing Register Machines
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-101">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-101" aria-expanded="false" aria-controls="sidebar-collapse-101">
                <a href="./5.1.2.html"> 5.1.2 
    Abstraction in Machine Design
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-102">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-102" aria-expanded="false" aria-controls="sidebar-collapse-102">
                <a href="./5.1.3.html"> 5.1.3 
    Subroutines
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-103">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-103" aria-expanded="false" aria-controls="sidebar-collapse-103">
                <a href="./5.1.4.html"> 5.1.4 
    Using a Stack to Implement Recursion
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-104">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-104" aria-expanded="false" aria-controls="sidebar-collapse-104">
                <a href="./5.1.5.html"> 5.1.5 
    Instruction Summary
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-105">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-105" aria-expanded="true" aria-controls="sidebar-collapse-105">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-105" aria-expanded="true" aria-controls="sidebar-collapse-105">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.2.html">5.2 A Register-Machine Simulator</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-105" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-106">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-106" aria-expanded="false" aria-controls="sidebar-collapse-106">
                <a href="./5.2.1.html"> 5.2.1 
    The Machine Model
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-107">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-107" aria-expanded="false" aria-controls="sidebar-collapse-107">
                <a href="./5.2.2.html"> 5.2.2 
    The Assembler
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-108">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-108" aria-expanded="false" aria-controls="sidebar-collapse-108">
                <a href="./5.2.3.html"> 5.2.3 
    
      <span style="color:green">Generating Execution Procedures for Instructions</span>
      <span style="color:blue">Instructions and their Execution Functions</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-109">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-109" aria-expanded="false" aria-controls="sidebar-collapse-109">
                <a href="./5.2.4.html"> 5.2.4 
    Monitoring Machine Performance
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-110">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-110" aria-expanded="true" aria-controls="sidebar-collapse-110">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-110" aria-expanded="true" aria-controls="sidebar-collapse-110">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.3.html">5.3 Storage Allocation and Garbage Collection</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-110" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-111">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-111" aria-expanded="false" aria-controls="sidebar-collapse-111">
                <a href="./5.3.1.html"> 5.3.1 
    Memory as Vectors
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-112">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-112" aria-expanded="false" aria-controls="sidebar-collapse-112">
                <a href="./5.3.2.html"> 5.3.2 
    Maintaining the Illusion of Infinite Memory
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-113">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-113" aria-expanded="true" aria-controls="sidebar-collapse-113">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-113" aria-expanded="true" aria-controls="sidebar-collapse-113">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.4.html">5.4 The Explicit-Control Evaluator</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-113" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-114">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-114" aria-expanded="false" aria-controls="sidebar-collapse-114">
                <a href="./5.4.1.html"> 5.4.1 
    
      <span style="color:green">The Core of the Explicit-Control Evaluator</span>
      <span style="color:blue">The Dispatcher and Basic Evaluation</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-115">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-115" aria-expanded="false" aria-controls="sidebar-collapse-115">
                <a href="./5.4.2.html"> 5.4.2 
        Evaluating function applications
      </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-116">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-116" aria-expanded="false" aria-controls="sidebar-collapse-116">
                <a href="./5.4.3.html"> 5.4.3 
    
      <span style="color:green">
        Conditionals, Assignments and Definitions
      </span>
      <span style="color:blue">
        Blocks, Assignments, and Declarations
      </span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-117">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-117" aria-expanded="false" aria-controls="sidebar-collapse-117">
                <a href="./5.4.4.html"> 5.4.4 
    Running the Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-118">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-118" aria-expanded="true" aria-controls="sidebar-collapse-118">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-118" aria-expanded="true" aria-controls="sidebar-collapse-118">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.5.html">5.5 Compilation</a>
                </h5>
              </div>
    
              <div id="sidebar-collapse-118" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-119">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-119" aria-expanded="false" aria-controls="sidebar-collapse-119">
                <a href="./5.5.1.html"> 5.5.1 
    Structure of the Compiler
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-120">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-120" aria-expanded="false" aria-controls="sidebar-collapse-120">
                <a href="./5.5.2.html"> 5.5.2 
    Compiling
    
      <span style="color:green">Expressions</span>
      <span style="color:blue">Components</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-121">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-121" aria-expanded="false" aria-controls="sidebar-collapse-121">
                <a href="./5.5.3.html"> 5.5.3 
    Compiling
    
      <span style="color:green">
	Combinations
      </span>
      <span style="color:blue">
	Applications
      </span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-122">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-122" aria-expanded="false" aria-controls="sidebar-collapse-122">
                <a href="./5.5.4.html"> 5.5.4 
    Combining Instruction Sequences
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-123">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-123" aria-expanded="false" aria-controls="sidebar-collapse-123">
                <a href="./5.5.5.html"> 5.5.5 
    An Example of Compiled Code
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-124">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-124" aria-expanded="false" aria-controls="sidebar-collapse-124">
                <a href="./5.5.6.html"> 5.5.6 
    Lexical Addressing
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-125">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-125" aria-expanded="false" aria-controls="sidebar-collapse-125">
                <a href="./5.5.7.html"> 5.5.7 
    Interfacing Compiled Code to the Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-126">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-126" aria-expanded="false" aria-controls="sidebar-collapse-126">
                <a href="./references.html"> References</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-127">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-127" aria-expanded="false" aria-controls="sidebar-collapse-127">
                <a href="./making-of.html"> About the SICP JS Project</a>
              </span>
            </h5>
          </div>
        </div>
        </div>
<div id='permalink-msg'>
<div class='screen'>
  <div class='alert alert-success'>
    <strong>Permalink copied!</strong>
  </div>
</div>
</div>
<div class='chapter-content'>

      <div class='chapter-title'>
        <div class='permalink'>
        <a name='top' class='permalink'> 
    2.2.3&nbsp;&nbsp;
    Sequences as Conventional Interfaces
  
        </a>
        </div>
      </div>
      <div class='chapter-text'>
        <div class='SECTION'>
    

  
  
  

  <div class='permalink'>
<a name='p1' class='permalink'></a><p>
    In working with compound data, we've stressed how data abstraction
    permits us to design programs without becoming enmeshed in the details
    of data representations, and how abstraction preserves for us the
    flexibility to experiment with alternative representations.  In this
    section, we introduce another powerful design principle for working
    with data structures—the use of <EM>conventional interfaces</EM>.
  </p></div>

  <div class='permalink'>
<a name='p2' class='permalink'></a><p>
    In section&nbsp;<REF NAME="sec:higher-order-procedures"><a class="superscript" id="2.2.3-sec-link-1.3" href="./1.3.html">1.3</a></REF> we saw how
    program abstractions, implemented as higher-order
    
      <span style="color:green">procedures,</span>
    <span style="color:blue">functions,</span>
    can capture common patterns in programs that deal with numerical data. Our
    ability to formulate analogous operations for working with compound data
    depends crucially on the style in which we manipulate our data structures.
    Consider, for example, the following
    
      <span style="color:green">procedure,</span>
      <span style="color:blue">function,</span>
    
    analogous to the
    
      <span style="color:green"><kbd>count-leaves</kbd></span>
      <span style="color:blue"><kbd>count_leaves</kbd></span>
    
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    of section&nbsp;<REF NAME="sec:trees"><a class="superscript" id="2.2.3-sec-link-2.2.2" href="./2.2.2.html">2.2.2</a></REF>, which takes a tree as argument
    and computes the sum of the squares of the leaves that are odd:
    
     
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_1_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (sum-odd-squares tree)
  (cond ((null? tree) 0)  
        ((not (pair? tree))
          (if (odd? tree) (square tree) 0))
        (else (+ (sum-odd-squares (car tree))
          (sum-odd-squares (cdr tree))))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_1_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBnARwIEMAnAUwAoAPASlADe2UCNAcyBVrW6gAVKG4BubAF9chUpRqgKdAPpUAJoc5F+Q0WPYSpoWgFJUoALyvQARmVr8xctVp0BAC2BsZ6jCwcdJxkHOzmwqLikrS6ekQEADaZMXG8iZaFAPygAAwFhaIAXKAAhDr6AA7MFKy57PEVlaAlaUYmsR38JRFsXIPxoDXl3ZY1gSH94Uxj0QAW7MwDefwA1F2zC6GGy5Hs0WQtORO8vF64R0ujUZyZumSv75woADSgmLw-m86B8ACx-ACstzuQA')">function sum_odd_squares(tree) {
    return is_null(tree)
           ? 0
           : ! is_pair(tree)
           ? is_odd(tree) ? square(tree) : 0
           : sum_odd_squares(head(tree)) +
             sum_odd_squares(tail(tree));
}
</pre></div></div></td></tr></table>
     
    
  </p></div>
  <div class='permalink'>
<a name='p3' class='permalink'></a><p>
    On the surface, this
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    is very different from the following one, which constructs a list of all
    the even Fibonacci numbers
    ${\textrm{Fib}}(k)$, where
    $k$ is less than or equal to a given integer
    $n$:
     
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_2_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (even-fibs n)
  (define (next k)
    (if (> k n)
      nil
      (let ((f (fib k)))
        (if (even? f)
          (cons f (next (+ k 1)))
          (next (+ k 1))))))
  (next 0))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_2_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQKBnAfQFMA3ZogCiIEpQBvbKGGgATszIFRtWgFJUoALzLQABgDc2AL65CpSjVB4KAI259BIsRKkylK1UKvPQAfjVOXIgFyhayxVAARk8vN2DQr19jM1oAWmC+AGojU25QBJQeTR18YnJqWjYORhj6cwFQvQLDImYADzJOAGsLSJEKPFAW0AA+Pzawq3FJaT8CABsJzTCtUGYJ+mZKoZESGnoyIyVUs1aZ1etR2gYWdi48HnbD4XcABwBDClFOPAAaPwam5tAUoJ4rjcop9Gj0-tlrqAdFZoSIRrYQU1VBDcsUiKVTOUAJzZIA')">function even_fibs(n) {
    function next(k) {
        if (k > n) {
            return null;
        } else {
            const f = fib(k);
            return is_even(f)
                   ? pair(f, next(k + 1))
                   : next(k + 1);
        }
    }
    return next(0);
}
</pre></div></div></td></tr></table>
    
  </p></div>
  <div class='permalink'>
<a name='p4' class='permalink'></a><p>
    Despite the fact that these two
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    are structurally very different, a more abstract description of the two
    computations reveals a great deal of similarity.  The first program
    <UL>
      <LI>
	enumerates the leaves of a tree;
      </LI>
      <LI>
	filters them, selecting the odd ones;
      </LI>
      <LI>
	squares each of the selected ones; and
      </LI>
      <LI>
	accumulates the results using
	
	  <span style="color:green"><kbd>+</kbd>,</span>
	  <span style="color:blue"><kbd>+</kbd>,</span>
	
	starting with 0.
      </LI>
    </UL>
  </p></div>
  <div class='permalink'>
<a name='p5' class='permalink'></a><p>
    The second program
    <UL>
      <LI>
	enumerates the integers from 0 to $n$;
      </LI>
      <LI>
	computes the Fibonacci number for each integer;
      </LI>
      <LI>
	filters them, selecting the even ones; and
      </LI>
      <LI>
	accumulates the results using
	
	  <span style="color:green"><kbd>cons</kbd>,</span>
	  <span style="color:blue"><kbd>pair</kbd>,</span>
	
	starting with the empty list.
      </LI>
    </UL>
  </p></div>
  <div class='permalink'>
<a name='p6' class='permalink'></a><p>
    
    
    A signal-processing engineer would find it natural to conceptualize these
    processes in terms of signals flowing through a cascade of stages, each of
    which implements part of the program plan, as shown in
    
      <span style="color:green">figure&nbsp;<REF NAME="fig:signal-flow-plans_scheme"><a class="superscript" id="2.2.3-fig-link-2.13" href="./2.2.3.html#fig_2.13">2.13</a></REF>.</span>
      <span style="color:blue">figure&nbsp;<REF NAME="fig:signal-flow-plans"><a class="superscript" id="2.2.3-fig-link-2.14" href="./2.2.3.html#fig_2.14">2.14</a></REF>.
      </span>
    
    In
    
      <span style="color:green"><kbd>sum-odd-squares</kbd>,</span>
      <span style="color:blue"><kbd>sum_odd_squares</kbd>,
      </span>
    
    we begin with an 
    
    <EM>enumerator</EM>, which generates a <QUOTE>signal</QUOTE> consisting of
    the leaves of a given tree.  This signal is passed through a 
    
    <EM>filter</EM>, which eliminates all but the odd elements. The resulting
    signal is in turn passed through a 
    
    <EM>map</EM>, which is a <QUOTE>transducer</QUOTE> that applies the
    <kbd>square</kbd>
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    to each element.  The output of the map is then fed to an 
    
    <EM>accumulator</EM>, which combines the elements using
    
      <span style="color:green"><kbd>+</kbd>,</span>
      <span style="color:blue"><kbd>+</kbd>,</span>
    
    starting from an initial 0. The plan for
    
      <span style="color:green"><kbd>even-fibs</kbd></span>
      <span style="color:blue"><kbd>even_fibs</kbd></span>
    
    is analogous.
    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
        
          
          
        
    <FIGURE>
      <img class="scale_factor_" id="fig_2.13" src="../img_original/ch2-Z-G-17.svg">
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./2.2.3.html#fig_2.13">Figure 2.13 </a></b>The signal-flow plans for the procedures
          <kbd>sum-odd-squares</kbd> (top) and
	  <kbd>even-fibs</kbd>
	  (bottom) reveal the commonality between the two programs.
          </div>
    </FIGURE>
  
      </span>    </td>
          <td></td>
          <td><span style="color:blue">
        
          
          
        
    <FIGURE>
      <img class="scale_factor_" id="fig_2.14" src="../img_javascript/ch2-Z-G-17.svg">
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./2.2.3.html#fig_2.14">Figure 2.14 </a></b>The signal-flow plans for the
          functions
          <kbd>sum_odd_squares</kbd> (top) and
	  <kbd>even_fibs</kbd> (bottom) reveal the
          commonality between the two programs.
          </div>
    </FIGURE>
  
      </span></td></tr></table>
  </p></div>
  <div class='permalink'>
<a name='p7' class='permalink'></a><p>
    Unfortunately, the two
    
      <span style="color:green">procedure definitions</span>
      <span style="color:blue">function declarations</span>
    
    above fail to exhibit this signal-flow structure.  For instance, if we
    examine the
    
      <span style="color:green"><kbd>sum-odd-squares</kbd></span>
      <span style="color:blue"><kbd>sum_odd_squares</kbd>
      </span>
    
    
      <span style="color:green">procedure,</span>
      <span style="color:blue">function,</span>
    
    we find that the enumeration is implemented partly by the
    
      <span style="color:green"><kbd>null?</kbd></span>
      <span style="color:blue"><kbd>is_null</kbd></span>
    
    and
    
      <span style="color:green"><kbd>pair?</kbd></span>
      <span style="color:blue"><kbd>is_pair</kbd></span>
    
    tests and partly by the tree-recursive structure of the
    
      <span style="color:green">procedure.</span>
      <span style="color:blue">function.</span>
    
    Similarly, the accumulation is found partly in the tests and partly in the
    addition used in the recursion.  In general, there are no distinct parts of
    either
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    that correspond to the elements in the signal-flow description. Our two
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    decompose the computations in a different way, spreading the enumeration
    over the program and mingling it with the map, the filter, and the
    accumulation.  If we could organize our programs to make the signal-flow
    structure manifest in the
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    we write, this would increase the conceptual clarity of the resulting
    
      <span style="color:green">code.</span>
      <span style="color:blue">program.</span>
    
  </p></div>

  
      <div class='permalink'>
        <a name='h1' class='permalink'></a><h2>
    
    Sequence Operations
  </h2></div>

  
  

  <div class='permalink'>
<a name='p8' class='permalink'></a><p>
    The key to organizing programs so as to more clearly reflect the
    signal-flow structure is to concentrate on the <QUOTE>signals</QUOTE> that
    flow from one stage in the process to the next.  If we represent these
    signals as lists, then we can use list operations to implement the
    processing at each of the stages.  For instance, we can implement the
    mapping stages of the signal-flow diagrams using the
    <kbd>map</kbd>
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    from section&nbsp;<REF NAME="sec:sequences"><a class="superscript" id="2.2.3-sec-link-2.2.1" href="./2.2.1.html">2.2.1</a></REF>:
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_3_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(map square (list 1 2 3 4 5))</pre><pre class='prettyprintoutput'>
            (1 4 9 16 25)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_3_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBnARwIEMAnAUwAoAPASlADe2UCNAcyBVrW6gAVKG4BubAF9chUpRqgAtswAOnDQBpQFMux11+Q0WPYSpZugH0iBADYfO5y9eF2gaAA-KDuXgFBogBcoPrMFKxGxJwAFuzMACY+Fla8vKaRUcV6hiagZAnevnn5ymrYpZyMLBymHhR0ZJwAjKYoppimACymAKx1QA')">map(square, list(1, 2, 3, 4, 5));
</pre><pre class='prettyprintoutput'>      
list(1, 4, 9, 16, 25)</pre></div></div></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p9' class='permalink'></a><p>
    Filtering a sequence to select only those elements that satisfy a given
    predicate is accomplished by
     
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_4_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (filter predicate sequence)
  (cond ((null? sequence) nil)
        ((predicate (car sequence))
          (cons (car sequence)
                (filter predicate (cdr sequence))))
        (else (filter predicate (cdr sequence)))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_4_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQ8KAbMgUwCcAKAB1eYBMKSAQxYAaUAGdmARwLNSzAJSgA3tlDrQPMgVa0K4gPpECDBu0ky5JRWo12NAflDHTt+3YBcobnwHDm7AAWzIK85tKy8goKbu7qTpyCFBzBoeGWUWKxcXH0TGxcPPxCoqBkSWYWkdbRMTkaXnksHD7F-mLljOnVigoA3NgAvriEpJQ0oPoGVLxhREqqdlo6tLQApKigALw7oACMA8NNBVMzvGIM+mTse2IoYphiACxiAKzRfUA')">function filter(predicate, sequence) {
    return is_null(sequence)
           ? null
           : predicate(head(sequence))
           ? pair(head(sequence), 
                  filter(predicate, tail(sequence)))
           : filter(predicate, tail(sequence));
}
</pre></div></div></td></tr></table>
    
    For example,
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_5_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(filter odd? (list 1 2 3 4 5))</pre><pre class='prettyprintoutput'>
            (1 3 5)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_5_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQ8KAbMgUwCcAKAB1eYBMKSAQxYAaUAGdmARwLNSzAJSgA3tlDrQPMgVa0K4gPpECDBu0ky5JRWo12NAflDHTt+3YBcobnwHDm7AAWzIK85tKy8goKbu7qTpyCFBzBoeGWUWKxcXH0TGxcPPxCoqBkSWYWkdbRMTkaXnksHD7F-mLljOnVigoA3NgAvriEpJQ0oPoGVLxhREqqdlo6tLQApKigALw7oACMA8P4jM3sUzO8Ygz6ZOx7YihimGIALGIArNF9QA')">filter(is_odd, list(1, 2, 3, 4, 5));
</pre><pre class='prettyprintoutput'>      
list(1, 3, 5)</pre></div></div></td></tr></table>
  </p></div>
  <div class='permalink'>
<a name='p10' class='permalink'></a><p>
  Accumulations can be implemented by
  
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_6_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (accumulate op initial sequence)
  (if (null? sequence)
    initial
    (op (car sequence)
        (accumulate op initial (cdr sequence)))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_6_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBDEkggWwIBs6yBTACioAcANKApEKlOm2EBnLgEcCXUlwCUoAN7ZQ20ACcuZArtoVpAfSLs2PWQqUlVWnc50B+EWIlsnL5wC5QAR4ACy46ABMbeUVlFWEfX0SGJlYObj4hD3EKSWEyOgprWxiHFTKAbmwAXyA')">function accumulate(op, initial, sequence) {
    return is_null(sequence)
           ? initial
           : op(head(sequence), 
                accumulate(op, initial, tail(sequence)));
}
</pre></div></div></td></tr></table>
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_7_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(accumulate + 0 (list 1 2 3 4 5))</pre><pre class='prettyprintoutput'>
15</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_7_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBDEkggWwIBs6yBTACioAcANKApEKlOm2EBnLgEcCXUlwCUoAN7ZQ20ACcuZArtoVpAfSLs2PWQqUlVWnc50B+EWIlsnL5wC5QAR4ACy46ABMbeUVlFWEfX0SGJlYObj4hD3EKSWEyOgprWxiHFTKAbmwAX1xCUkoaUH42AmkeAA9hAE81TWd9Q2NQdtAAalAuyprsZJZ2Tl5m1uEABmE2UzIeAEZhFGFMYQAWYQBWCqA')">accumulate(plus, 0, list(1, 2, 3, 4, 5));
</pre><pre class='prettyprintoutput'>
15</pre></div></div></td></tr></table>
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_8_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(accumulate * 1 (list 1 2 3 4 5))</pre><pre class='prettyprintoutput'>
            120</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_8_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBDEkggWwIBs6yBTACioAcANKApEKlOm2EBnLgEcCXUlwCUoAN7ZQ20ACcuZArtoVpAfSLs2PWQqUlVWnc50B+EWIlsnL5wC5QAR4ACy46ABMbeUVlFWEfX0SGJlYObj4hD3EKSWEyOgprWxiHFTKAbmwAX1xCUkoaUEpmLmkeAA9hAE81TWd9Q2NQdtAAKlAuyprsZJZ2Tl5m1uEARmE2UzIeNdRhTGEAFmEAVgqgA')">accumulate(times, 1, list(1, 2, 3, 4, 5));
</pre><pre class='prettyprintoutput'>
120</pre></div></div></td></tr></table>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_9_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(accumulate cons nil (list 1 2 3 4 5))</pre><pre class='prettyprintoutput'>
(1 2 3 4 5)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_9_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBDEkggWwIBs6yBTACioAcANKApEKlOm2EBnLgEcCXUlwCUoAN7ZQ20ACcuZArtoVpAfSLs2PWQqUlVWnc50B+EWIlsnL5wC5QAR4ACy46ABMbeUVlFWEfX0SGJlYObj4hD3EKSWEyOgprWxiHFTKAbmwAX1xklnZOXn4C3WFLNilQNlMyHgBGYRRhTGEAFmEAVgqgA')">accumulate(pair, null, list(1, 2, 3, 4, 5));
</pre><pre class='prettyprintoutput'>
list(1, 2, 3, 4, 5)</pre></div></div></td></tr></table>
  </p></div>
  <div class='permalink'>
<a name='p11' class='permalink'></a><p>
    All that remains to implement signal-flow diagrams is to enumerate the
    sequence of elements to be processed.  For
    
      <span style="color:green"><kbd>even-fibs</kbd>,</span>
      <span style="color:blue"><kbd>even_fibs</kbd>,</span>
    
    we need to generate the sequence of integers in a given range, which we
    can do as follows:
     
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_10_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (enumerate-interval low high)
   (if (> low high)
      nil
      (cons low (enumerate-interval (+ low 1) high))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_10_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBTIggWzoCcBDMugfQqK9YA3dgBsAFCKoB3ADSgAFhQDm8gJSgA3tlA7QrOmQKtakqaAB8C5fO267ugPyhGIkbft2AXKAAO7CqwS0jLuHmE6DMxsnDx8AsLipqAA1KAAjHKKKqqqANzYAL64kSwcXLz8bAliKHIA7HlAA')">function enumerate_interval(low, high) {
    return low > high
           ? null
           : pair(low,
                  enumerate_interval(low + 1, high));
}
</pre></div></div></td></tr></table>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_11_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(enumerate-interval 2 7)</pre><pre class='prettyprintoutput'>
(2 3 4 5 6 7)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_11_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBTIggWzoCcBDMugfQqK9YA3dgBsAFCKoB3ADSgAFhQDm8gJSgA3tlA7QrOmQKtakqaAB8C5fO267ugPyhGIkbft2AXKAAO7CqwS0jLuHmE6DMxsnDx8AsLipqAA1KAAjHKKKqqqANzYAL64kSwcXLz8bAliKHIA7HlAA')">enumerate_interval(2, 7);
</pre><pre class='prettyprintoutput'>
list(2, 3, 4, 5, 6, 7)</pre></div></div></td></tr></table>
  </p></div>
  <div class='permalink'>
<a name='p12' class='permalink'></a><p>
    To enumerate the leaves of a tree, we can use<a class='superscript' id='footnote-link-1' href='#footnote-1'>[1]</a>
    
     
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_12_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (enumerate-tree tree)
   (cond ((null? tree) nil)
         ((not (pair? tree)) (list tree))
         (else (append (enumerate-tree (car tree))
                       (enumerate-tree (cdr tree))))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_12_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBTIggWzoCcBDMugfTNbroAKPgICUoAN7ZQM0PzIFWtCgGdujADYbh-OqOmzDsgPyhNGg0cMAuUAEJQq7gAd2FVjrGWrM0xtVknnrePrbszs4MACaCDMxsnDwiQgAWdOwxyaKiADQhPgVxLBxcvLrCbtpZ2QDc2AC+uEUJpcmC-iqBAIw5oB2BKL39gpi9ACzZvQCstUA')">function enumerate_tree(tree) {
    return is_null(tree)
           ? null
           : ! is_pair(tree)
           ? list(tree)
           : append(enumerate_tree(head(tree)),
                    enumerate_tree(tail(tree)));
}
</pre></div></div></td></tr></table>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_13_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(enumerate-tree (list 1 (list 2 (list 3 4)) 5))</pre><pre class='prettyprintoutput'>
(1 2 3 4 5)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_13_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBTIggWzoCcBDMugfTNbroAKPgICUoAN7ZQM0PzIFWtCgGdujADYbh-OqOmzDsgPyhNGg0cMAuUAEJQq7gAd2FVjrGWrM0xtVknnrePrbszs4MACaCDMxsnDwiQgAWdOwxyaKiADQhPgVxLBxcvLrCbtpZ2QDc2AC+uEUJpcmC-iqBAIw5oB2BKL39gpi9ACzZvQCstUA')">enumerate_tree(list(1, list(2, list(3, 4)), 5));
</pre><pre class='prettyprintoutput'>
list(1, 2, 3, 4, 5)</pre></div></div></td></tr></table>
  </p></div>
  <div class='permalink'>
<a name='p13' class='permalink'></a><p>
    Now we can reformulate
    
      <span style="color:green"><kbd>sum-odd-squares</kbd></span>
      <span style="color:blue"><kbd>sum_odd_squares</kbd>
      </span>
    
    and
    
      <span style="color:green"><kbd>even-fibs</kbd></span>
      <span style="color:blue"><kbd>even_fibs</kbd></span>
    
    as in the signal-flow diagrams.  For
    
      <span style="color:green"><kbd>sum-odd-squares</kbd>,</span>
      <span style="color:blue"><kbd>sum_odd_squares</kbd>,
    </span>
    we enumerate the sequence of leaves of the tree, filter this to keep only
    the odd numbers in the sequence, square each element, and sum the results:
     
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_14_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (sum-odd-squares tree)
   (accumulate +
               0
               (map square
                 (filter odd?
                  (enumerate-tree tree)))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_14_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBnARwIEMAnAUwAoAPASlADe2UCNAcyBVrW6gAVKG4BubAF9chUpRqgADgBsCdHgBpQAT35DRY9hKkLQAanPK1+YuWq0KdAPpUAEwDOIkthUXFJWloAUlRQAF4k0ABGV3UPLVp2IgIAW3ZWZjJ2XzIOLnL2djDrSPsfX1y9PU4qmvDrLoB+UGa9Tq7RAC5QAEJQRp1mClY2it5BodBevR8yeerF5etR5h0dHOCc-MLi0vbOAAt2ZmD23l5jJZ3lk4KikrKKtpnWh8e6Xcmi89Hy-iCvkYLA4RgegkG9VozBIJHyBD0504+kMpher2WAAY8QTSaA8vtONC2OwSWT6XgKHoSnNGoEAnT6VzrO8zl9LgDAapcHRweyoUwaUY1nQNjKNihTJgnqB5ZwACymACsj14iiAA')">function sum_odd_squares(tree) {
    return accumulate(plus, 
                      0, 
                      map(square, 
                          filter(is_odd, 
                                 enumerate_tree(tree))));
}
</pre></div></div></td></tr></table>
  </p></div>
  <div class='permalink'>
<a name='p14' class='permalink'></a><p>
    For
    
      <span style="color:green"><kbd>even-fibs</kbd>,</span>
      <span style="color:blue"><kbd>even_fibs</kbd>,</span>
    
    we enumerate the integers from 0 to $n$, generate
    the Fibonacci number for each of these integers, filter the resulting
    sequence to keep only the even elements, and accumulate the results
    into a list:
     
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_15_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (even-fibs n)
   (accumulate cons
               nil
               (filter even?
                 (map fib
                      (enumerate-interval 0 n)))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_15_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQKBnAfQFMA3ZogCiIEpQBvbKGGgATszIFRtWgFJUoALzLQABgDc2AL65CpSjVB4KAI259BIsRKkylK1UKvPQAfjVOXIgFyhayxVAARk8vN2DQr19jM1oAWmC+AGojU25QBJQeTR18YnJqWg4CAFtmUQBDMmZGCiJq0VYKgBtOZqoAdwAaUAALCgBzXotQ8UlpUHaO0AA+PsHeyJd3IgJm5qXnXwAHCopRNs6uzbCRYrLK6tr68qbWqdAUoJ7+oZ5s7V18gyL2IkYYvRzAJRjYJhUSCRSmsqsxOLt9j0TqdnKt1kiUZjUs0GpwGCw-hiscSRCUKttODEiSSacJzuVYdcGndOKoerx3h9cmwOADTECAJzZIA')">function even_fibs(n) {
    return accumulate(pair, 
                      null, 
                      filter(is_even, 
                             map(fib, 
                                 enumerate_interval(0, n))));
}
</pre></div></div></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p15' class='permalink'></a><p>
    The value of expressing programs as sequence operations is that this
    helps us make program designs that are modular, that is, designs that
    are constructed by combining relatively independent pieces.  We can
    encourage modular design by providing a library of standard components
    together with a conventional interface for connecting the components
    in flexible ways.
  </p></div>

  <div class='permalink'>
<a name='p16' class='permalink'></a><p>
    
    
    Modular construction is a powerful strategy for controlling complexity in
    engineering design.  In real signal-processing applications, for example,
    designers regularly build systems by cascading elements selected from
    standardized families of filters and transducers.  Similarly, sequence
    operations provide a library of standard program elements that we can mix
    and match.  For instance, we can reuse pieces from the
    
      <span style="color:green"><kbd>sum-odd-squares</kbd></span>
      <span style="color:blue"><kbd>sum_odd_squares</kbd>
      </span>
    
    and <kbd>even-fibs</kbd>
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    in a program that constructs a list of the squares of the first
    $n+1$ Fibonacci numbers:
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_16_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (list-fib-squares n)
  (accumulate cons
              nil
              (map square
                   (map fib
                        (enumerate-interval 0 n)))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_16_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBnARwIEMAnAUwAoAPASlADe2UCNAcyBVrW6gAVKG4BubAF9chUpRqg8FAEaci-IaLHsJU0LQC8t0AAZhp56AD8Dpy9EAuK6FvWoACMnl5uwaFevroGtAC0wfwA1Dr6hqAJKLzKavjE5NS07EQEALbsrMxk7AD6FETVrABuzAA2nK1UAO4ANKAAFhQA5v3GoeKStJ1doAB8A8P9kS7uJa2ty86+AA7MFKwd3T2bYaLFZRVVtfWNLe3ToClBfYMjvNmq6vlaUxR0ZDUYjVGCwOHRDGNTBNLMwSCQygRWldOLt9n0TqdnGtWujMXjQKVmNtOCC2OxcfjKYTiTEKZT6aBzuVKtU6g0KndOPY+kZ3h9cq0-gCgaSwZwgvZskA')">function list_fib_squares(n) {
    return accumulate(pair, 
                      null, 
                      map(square, 
                          map(fib, 
                              enumerate_interval(0, n))));
}
</pre></div></div></td></tr></table>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_17_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(list-fib-squares 10)</pre><pre class='prettyprintoutput'>
(0 1 1 4 9 25 64 169 441 1156 3025)</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_17_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBnARwIEMAnAUwAoAPASlADe2UCNAcyBVrW6gAVKG4BubAF9chUpRqg8FAEaci-IaLHsJU0LQC8t0AAZhp56AD8Dpy9EAuK6FvWoACMnl5uwaFevroGtAC0wfwA1Dr6hqAJKLzKavjE5NS07EQEALbsrMxk7AD6FETVrABuzAA2nK1UAO4ANKAAFhQA5v3GoeKStJ1doAB8A8P9kS7uJa2ty86+AA7MFKwd3T2bYaLFZRVVtfWNLe3ToClBfYMjvNmq6vlaUxR0ZDUYjVGCwOHRDGNTBNLMwSCQygRWldOLt9n0TqdnGtWujMXjQKVmNtOCC2OxcfjKYTiTEKZT6aBzuVKtU6g0KndOPY+kZ3h9cq0-gCgaSwZwgvZskA')">list_fib_squares(10);
</pre><pre class='prettyprintoutput'>
list(0, 1, 1, 4, 9, 25, 64, 169, 441, 1156, 3025)</pre></div></div></td></tr></table>
  </p></div>
  <div class='permalink'>
<a name='p17' class='permalink'></a><p>
    We can rearrange the pieces and use them in computing the product of the
    squares of the odd integers in a sequence:
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_18_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (product-of-squares-of-odd-elements sequence)
  (accumulate *
              1
              (map square
                (filter odd? sequence))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_18_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBnARwIEMAnAUwAoAPASlADe2UCNAcyBVrW6gAVKG4BubAF9chUpRqgKdAPpUAJoc5F+Q0WPYSpoWgFJUoALyvQARmVr8xctVqUALbsdDwANKAAnubCouKS0nJRXuq+WrQADqxGBOQGeHqMLBz6VAVGhnrsADbswURkoXTsTOyk7DGW8bbMJCQEgQTVzGRcQSERsZbTM9Puk7OLs4HMGZxFbOwLSzszeBTVo6ycugbGEc2t7bw3KdhZOXllhUybpeXGVbX1jZzVumROPNUBFMBEACwRACstyAA')">function product_of_squares_of_odd_elements(sequence) {
    return accumulate(times, 
                      1, 
                      map(square, 
                          filter(is_odd, sequence)));
}
</pre></div></div></td></tr></table>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_19_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(product-of-squares-of-odd-elements (list 1 2 3 4 5))</pre><pre class='prettyprintoutput'>
225</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_19_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBnARwIEMAnAUwAoAPASlADe2UCNAcyBVrW6gAVKG4BubAF9chUpRqgKdAPpUAJoc5F+Q0WPYSpoWgFJUoALyvQARmVr8xctVqUALbsdDwANKAAnubCouKS0nJRXuq+WrQADqxGBOQGeHqMLBz6VAVGhnrsADbswURkoXTsTOyk7DGW8bbMJCQEgQTVzGRcQSERsZbTM9Puk7OLs4HMGZxFbOwLSzszeBTVo6ycugbGEc2t7bw3KdhZOXllhUybpeXGVbX1jZzVumROPNUBFMBEACwRACstyAA')">product_of_squares_of_odd_elements(list(1, 2, 3, 4, 5));
</pre><pre class='prettyprintoutput'>
225</pre></div></div></td></tr></table>
  </p></div>
  <div class='permalink'>
<a name='p18' class='permalink'></a><p>
    We can also formulate conventional data-processing applications in terms of
    sequence operations.  Suppose we have a sequence of personnel records and
    we want to find the salary of the highest-paid programmer. Assume that we
    have a selector <kbd>salary</kbd> that returns the salary
    of a record, and a predicate
    
      <span style="color:green"><kbd>programmer?</kbd></span>
      <span style="color:blue"><kbd>is_programmer</kbd>
      </span>
    
    that tests if a record is for a programmer.  Then we can write
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_20_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (salary-of-highest-paid-programmer records)
  (accumulate max
              0
              (map salary
                   (filter programmer? records))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_20_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBnAQwBsGAnATwH0q9OALCgHM+AUzplOABwYUAJlNZVBrBgFtVI1gApWIklVay6ASlABvbKCuhdZAq1oMSJAqoIsyIraoZk+nHwAPABpQS2sIyKjrAAZQ8OjEyJ9JLUYWDnik7Oi8CiZPbQo6BSUVdU1Q3X1DE2NjAG5sAF9cfSJxUFUuaoMjUABeUCZisi0R8S0AIgAZCiICOinQqclFZTUNVmXQTBj9mONghJzsibGpgCUKEj42WR3V9fKtnZQAVgOjk9PE8+mAEL5JiPHxEBiCTRvT4HQ6NfDEcjUWjFUobCraXqGUwWCK2ey0UQMWRaMgyJg6PR9eqDAZDJ5lTZQpqtQikSg0ejMNjsSk1WQ4k74hygIkksn5UnkvnU+os7DpHncXgCYRiCTSORol6abw9Km1RpAA')">function salary_of_highest_paid_programmer(records) {
    return accumulate(math_max, 
                      0, 
                      map(salary, 
                          filter(is_programmer, records)));
}
</pre></div></div></td></tr></table>
  </p></div>
  <div class='permalink'>
<a name='p19' class='permalink'></a><p>
    These examples give just a hint of the vast range of operations that
    can be expressed as sequence operations.<a class='superscript' id='footnote-link-2' href='#footnote-2'>[2]</a>
  </p></div>
  <div class='permalink'>
<a name='p20' class='permalink'></a><p>
    Sequences, implemented here as lists, serve as a conventional interface
    that permits us to combine processing modules.  Additionally, when we
    uniformly represent structures as sequences, we have localized the
    data-structure dependencies in our programs to a small number of sequence
    operations.  By changing these, we can experiment with alternative
    representations of sequences, while leaving the overall design of our
    programs intact.  We will exploit this capability in
    section&nbsp;<REF NAME="sec:streams"><a class="superscript" id="2.2.3-sec-link-3.5" href="./3.5.html">3.5</a></REF>, when we generalize the
    sequence-processing paradigm to admit infinite sequences.
  </p></div>

  
    <div class="permalink">
    <a name="ex_2.34" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.34">Exercise 2.34 </a></b> 
  
    Fill in the missing expressions to complete the following definitions of
    some basic list-manipulation operations as accumulations:
    
    
    
    
    <kbd class='snippet'>
function map(f, sequence) {
    return accumulate((x, y) => $\langle{}$<EM>??</EM>$\rangle$, 
                      null, sequence);
}

function append(seq1, seq2) {
    return accumulate(pair, $\langle{}$<EM>??</EM>$\rangle$, $\langle{}$<EM>??</EM>$\rangle$);
}

function length(sequence) {
    return accumulate($\langle{}$<EM>??</EM>$\rangle$, 0, sequence);
}
      </kbd>
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_35_1_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_35_1_div"><SOLUTION>
    
      <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_21_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_21_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBbAQwAcAKPAGlAGcBTARwI9SPAJSgA3tlDTQAJx5kCs2gxIkCdAgBsGZHixYAPTgE8xAXgB8oJgwqy2RkaedSZ7j55lFtWzm69Aj14BIRJRAG5sAF9cQlJKGlBmJiEAExYQgEZOEJQxSXd5RWVktQ1tXX1be1z+FDq+LJEo2PxicmpaLSEAczIAC0z+QWECgLkFJRVyzR09A2NQM1ArZdAAalAciaCggAZ-PePuEbDImNxGVkZBgH0uPlkyTi0KLjIWHNROTE4AFhELWwIGSTFSRAybw+X04DVAmGcoGhn3+nAArJwAGxAqKgnpEfpDFGwn4IgG4oA')">function map(f, sequence) {
    return accumulate((x, y) => pair(f(x), y),
                      null, 
                      sequence);
}

function append(seq1, seq2) {
    return accumulate(pair, seq2, seq1);
}

function length(sequence) {
    return accumulate((x, y) => y + 1,
                      0, 
                      sequence);
}
</pre></div></div></td></tr></table>
    </SOLUTION></div></div>
</EXERCISE></div>


  
    <div class="permalink">
    <a name="ex_2.35" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.35">Exercise 2.35 </a></b> 
  
    
    
    Evaluating a polynomial in $x$ at a given value
    of $x$ can be formulated as an accumulation.
    We evaluate the polynomial
    
      \[ a_{n} x^n +a_{n-1}x^{n-1}+\cdots + a_{1} x+a_{0} \]
    
    using a well-known algorithm called 
    
    <EM>Horner's rule</EM>, which structures the computation as
    
      \[ \left(\cdots (a_{n}  x+a_{n-1})x+\cdots +a_{1}\right) x+a_{0} \]
    
    In other words, we start with $a_{n}$, multiply
    by $x$, add $a_{n-1}$,
    multiply by $x$, and so on, until we reach
    $a_{0}$.<a class='superscript' id='footnote-link-3' href='#footnote-3'>[3]</a>
    Fill in the following template to produce a
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    that evaluates a polynomial using Horner's rule. Assume that the
    coefficients of the polynomial are arranged in a sequence, from
    $a_{0}$ through
    $a_{n}$.
    <kbd class='snippet'>
function horner_eval(x, coefficient_sequence) {
    return accumulate((this_coeff, higher_terms) => $\langle{}$<EM>??</EM>$\rangle$,
                      0, 
                      coefficient_sequence);
}
      </kbd>
    For example, to compute $1+3x+5x^3+x^5$ at
    $x=2$ you would evaluate
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_22_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(horner-eval 2 (list 1 3 0 5 0 1))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_22_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQALKgJyIFNGB9FgNwEMAbABQAPADSgSVFnjwUSFFkTLsAziwCOBBSRYBKUAG9soY6EYsyBZqB4kSBALYE+PMiwECydCsvYSpeMS8Aczo2dldGe2U9AF4APlARIxMU1LSTAAYxZPTc1L9pWXlFFXVNUl0AbmwAX1wGZjDufgEUMT5vMgEARjFMMSzQAFYBsW6dHUqgA')">horner_eval(2, list(1, 3, 0, 5, 0, 1));
</pre></div></div></td></tr></table>
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_35_2_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_35_2_div"><SOLUTION>
    
      <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_23_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_23_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQALKgJyIFNGB9FgNwEMAbABQAPADSgSVFnjwUSFFkTLsAziwCOBBSRYBKUAG9soY6EYsyBZqB4kSBALYE+PMiwECydCsvYSpeMS8Aczo2dldGe2U9AF4APlAjE2SU1JMhUAAqegoQsIio0ABqUE9vX0lpESS02pSABjEaupa-aVl5RRV1TVJdAG5sAF9cBmYw7n4BFDE+bzIBAEYxTDFG0ABWNbFFnR1+oA')">function horner_eval(x, coefficient_sequence) {
    return accumulate((this_coeff, higher_terms) => 
                      x * higher_terms + this_coeff,
                      0, 
                      coefficient_sequence);
}
</pre></div></div></td></tr></table>
      
    </SOLUTION></div></div>
</EXERCISE></div>


  
    <div class="permalink">
    <a name="ex_2.36" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.36">Exercise 2.36 </a></b> 
  
    
    Redefine
    
      <span style="color:green"><kbd>count-leaves</kbd></span>
      <span style="color:blue"><kbd>count_leaves</kbd>
      </span>
    
    from section&nbsp;<REF NAME="sec:trees"><a class="superscript" id="2.2.3-sec-link-2.2.2" href="./2.2.2.html">2.2.2</a></REF> as an accumulation:
    
    <kbd class='snippet'>
function count_leaves(t) {
    return accumulate($\langle{}$<EM>??</EM>$\rangle$, $\langle{}$<EM>??</EM>$\rangle$, map($\langle{}$<EM>??</EM>$\rangle$, $\langle{}$<EM>??</EM>$\rangle$));
}
          </kbd>
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_35_3_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_35_3_div"><SOLUTION>
    
      <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_24_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_24_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQSriyB9AGwFMBDANzYGcAKMgEpQAb2yhJoAE5syBabQ4kSBALYEWHMm37923PgBpQZKmQ4sRAXgB8oAz16gA1KfOWjEqT99+pAAwm2ACQIX5qHAAO-LwEAEZMZLJsoHagFLxMURwU0rEJSSlCoeH+5X4A-HQMRMyOfAWJyWxsJRUdneUAXKAAjF5hZcJCANzYAL649IysnE78OXn6mWT8A6hCJiyr-JgmACxCx6NAA')">function count_leaves(t) {
    return accumulate((leaves, total) => leaves + total,
                      0, 
		      map(sub_tree => is_pair(sub_tree)
		                      ? count_leaves(sub_tree)
                                      : 1,
			  t));
}
</pre></div></div></td></tr></table></SOLUTION></div></div>
</EXERCISE></div>


  
    <div class="permalink">
    <a name="ex_2.37" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.37">Exercise 2.37 </a></b> 
  
    
    The
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    
      <span style="color:green"><kbd>accumulate-n</kbd></span>
      <span style="color:blue"><kbd>accumulate_n</kbd>
      </span>
    
    is similar to
    
      <span style="color:green">
      <kbd>accumulate</kbd></span>
      <span style="color:blue"><kbd>accumulate</kbd></span>
    
    except that it takes as its third argument a sequence of sequences, which
    are all assumed to have the same number of elements.  It applies the
    designated accumulation
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    to combine all the first elements of the sequences, all the second elements
    of the sequences, and so on, and returns a sequence of the results.  For
    instance, if <kbd>s</kbd> is a sequence containing four
    sequences
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_25_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
((1 2 3) (4 5 6) (7 8 9) (10 11 12))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_25_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
list(list( 1,  2,  3),
     list( 4,  5,  6),
     list( 7,  8,  9),
     list(10, 11, 12))</pre></div></div></td></tr></table>
    then the value of
    
      <span style="color:green">
	<kbd>(accumulate-n + 0 s)</kbd>
      </span>
      <span style="color:blue">
	<kbd>accumulate_n(plus, 0, s)</kbd>
      </span>
    
    should be the sequence
    
      <span style="color:green"><kbd>(22 26 30)</kbd>.</span>
      <span style="color:blue"><kbd>list(22, 26, 30)</kbd>.
      </span>
    
    Fill in the missing expressions in the following definition of
    
      <span style="color:green"><kbd>accumulate-n</kbd>:</span>
      <span style="color:blue"><kbd>accumulate_n</kbd>:
      </span>
    
     
    <kbd class='snippet'>
function accumulate_n(op, init, seqs) {
    return is_null(head(seqs))
           ? null
           : pair(accumulate(op, init, $\langle{}$<EM>??</EM>$\rangle$), 
                  accumulate_n(op, init, $\langle{}$<EM>??</EM>$\rangle$));
}
      </kbd>
    
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_35_4_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_35_4_div"><SOLUTION>
    
      <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_26_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_26_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQAHAGwIGcAKADwBpQBPASlABvbKFGgATgFMyBcbXagA1LwDc2AL65CpSjVABDEiQIBbAg31lJAfSKsqdbhSIUy3ZpICOzAcLETpWVoKZltzBlYAC0l9ABNWD28+PhF-NNAAflAicNT0sQAuen0KcVZDYzMLK3tHUGdXbhN9Og5QAF4APlBouI4+dy8fAbz8sYrTc0sbOwcnFzdQZtaFLtAyEoj2AdBE4b41TWwSGmYyXa9rRI7QBhCyVjuz1gBGbhRuTB2nh4AWbgArNwAGw7UZjCE-VgAdm4AA5uABOb73V4ABm4LzeoBeKGSagmVWmtlYjBY3AxF08Vy8ByAA')">function accumulate_n(op, init, seqs) {
    return is_null(head(seqs))
           ? null
           : pair(accumulate(op, init, map(x => head(x), seqs)),
                  accumulate_n(op, init, map(x => tail(x), seqs)));
}
</pre></div></div></td></tr></table></SOLUTION></div></div>
</EXERCISE></div>


  
    <div class="permalink">
    <a name="ex_2.38" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.38">Exercise 2.38 </a></b> 
  
    
    
    
    
    Suppose we represent vectors $v=(v_{i})$ as
    sequences of numbers, and matrices $m=(m_{ij})$
    as sequences of vectors (the rows of the matrix). For example, the matrix
    
      \[ \left[ 
      \begin{array}{llll}
      1 & 2 & 3 & 4\\
      4 & 5 & 6 & 6\\
      6 & 7 & 8 & 9\\
      \end{array}
      \right] \]
    
    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
        is represented as the sequence
	<kbd>((1 2 3 4) (4 5 6 6) (6 7 8 9))</kbd>.
      </span>    </td>
          <td></td>
          <td><span style="color:blue">
	is represented as the following sequence:
	<div class='snippet' id='javascript_35_27_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
list(list(1, 2, 3, 4),
     list(4, 5, 6, 6),
     list(6, 7, 8, 9))</pre></div></div>
      </span></td></tr></table>
    With this representation, we can use sequence operations to concisely
    express the basic matrix and vector operations.  These operations
    (which are described in any book on matrix algebra) are the following:
    <UL>
      <LI>
        
	  <span style="color:green">
	    <kbd>(dot-product </kbd>
	    $v$ $w$<kbd>)</kbd>
	  </span>
	  <span style="color:blue">
	    <kbd>dot_product(</kbd>$v$<kbd>, 	  </kbd>$w$<kbd>)</kbd></span>
	
	returns the sum $\sum_{i}v_{i} w_{i}$.
      </LI>
      <LI>
        
	  <span style="color:green">
	    <kbd>(matrix-*-vector 	  </kbd>$m$ $v$<kbd>)</kbd></span>
	  <span style="color:blue"><kbd>matrix_times_vector(</kbd>$m$<kbd>, 	  </kbd>$v$<kbd>)</kbd></span>
	
	returns the vector $t$, where
	$t_{i} =\sum_{j}m_{ij}v_{j}$.
      </LI>
      <LI>
        
	  <span style="color:green">
	    <kbd>(matrix-*-matrix </kbd>
	    $m\ n$<kbd>)</kbd>
	  </span>
	  <span style="color:blue">
	    <kbd>matrix_times_matrix(</kbd>$m$<kbd>, 	  </kbd>$n$<kbd>)</kbd></span>
	
	returns the matrix $p$, where
	$p_{ij}=\sum_{k} m_{ik}n_{kj}$.
      </LI>
      <LI>
        
	  <span style="color:green">
	    <kbd>(transpose 	    )</kbd></span><span style="color:blue"><kbd>transpose(</kbd>$m$<kbd>)</kbd></span>
	
	returns the matrix $n$, where
	$n_{ij}=m_{ji}$.
      </LI>
    </UL>
    We can define the dot product as<a class='superscript' id='footnote-link-4' href='#footnote-4'>[4]</a>
     
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_28_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (dot-product v w)
  (accumulate + 0 (map * v w)))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_28_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQAHAGwIGcAKADwBpQBPASlABvbKFGgATgFMyBcbXagA1LwDc2AL65CpSjVCUAtpLZdeA4WInTZ80ACpVGrcXLVaAQxIkCBgg3dkkgD6RKxUdNwURBRk3MySAI7M5iJiUjJyoBTMIX4MrAAWku4AJqzxSXx8qZa1APygRHk1tWIAXPTuFOKsnt6+-oFhEVnRsaAG7nQcoAC8AHygRaUcfHGJyWstrTugfT5+AcGh4ZFj3JPTCgv6Xfnsa6AVm3xqmvguurQlVGRBdOIqCUCORWAA3bgAdxSlnSNj2XgOg0krEYLG4AAZuNtdrj9gMjiFWIZjNwAIzcBjZMjgqFVV5ObA-P4AoEgmlU5g0imoR6cmmYbgAFiqKiAA')">function dot_product(v, w) {
    return accumulate(plus, 0, 
                      accumulate_n(times, 1, list(v, w)));
}
</pre></div></div></td></tr></table>
    
    Fill in the missing expressions in the following
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    for computing the other matrix operations.  (The
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    
      <span style="color:green">
	<kbd>accumulate-n</kbd>
	is defined in 	
      </span>
      <span style="color:blue">
	<kbd>accumulate_n</kbd>
	is declared in       
      </span>
    
    exercise&nbsp;<REF NAME="ex:accumulate-n"><a class="superscript" id="2.2.3-ex-link-2.37" href="./2.2.3.html#ex_2.37">2.37</a></REF>.)
     
     
    
    <kbd class='snippet'>
function matrix_times_vector(m, v) {
    return map($\langle{}$<EM>??</EM>$\rangle$, m);
}

function transpose(mat) {
    return accumulate_n($\langle{}$<EM>??</EM>$\rangle$, $\langle{}$<EM>??</EM>$\rangle$, mat);
}

function matrix_times_matrix(n, m) {
    const cols = transpose(n);
    return map($\langle{}$<EM>??</EM>$\rangle$, m);
}
      </kbd>
    
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_35_5_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_35_5_div"><SOLUTION>
    
      <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_29_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_29_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBDEkggWwIBs6yBTAfSIAoqABwA0oCkQpkxAZy4BHGQEpQAb2yhNoAE5cyBbbQoy+7NvwAWXOgBN+cxUqUatrrQH5QRMy7euAXKBCdBTa-AxMrBzcgqLiktKgzHRC-AAeoAC8AHygVrbpSrIKykW+fhWaESzsnLwCwmISUmLJqRk5oGQh5mlFoA6lSgDc2AC+uISklDRBbAQy6WIAnirqrrr6hqAZANSgy6MT+MTk1LSUzFyLaStr5ZsGtBkAVAdHk6cztDZUZDxCbRUGwEcj8ABuYgA7vcNnonvRGDVolx+EJ5jIxAAGMTlSr4xGRWrcPj8S7XMQARjEbGMZAh0KcI3Gn2m5ySnG0FDSPHJJnBXHIVDCzDE4NhWke2za-CBUKyuV+-0BwNB9LlYv6zGZxymZ1mZG0dCIMiEVDk-GSZAlmiltGqUTqpOCoTE3jYbFanB1rP1tCtXJ5fJ4Ae5-CIrRtoBINBkZGjVDYMiyXSNJrNFu1ozhW39KXSCo5qWWhaVAKBILBtwO-RjSf6RB92BjJvj4JTtLj-EpONQvcwWOZLbjSUpHbp-E79OpqDEmH6U-4mDEAFYqQuJzOt05RsP48wUOOu4uZyg5xuuwAWVdiABsF-pAHYxAAOMQATh3uFDQYoV35gpkMKlozuKowgKmxqmuaqLMJSzIQT+vJ-tcIacmGcGtCgIxAA')">function matrix_times_vector(m, v) {
    return map(row => dot_product(row, v), m);
}

function transpose(mat) {
    return accumulate_n(pair, null, mat);
}

function matrix_times_matrix(n, m) {
    const cols = transpose(m);
    return map(x => map(y => dot_product(x, y), cols), n);
}
</pre></div></div></td></tr></table>
    </SOLUTION></div></div>
</EXERCISE></div>


  
    <div class="permalink">
    <a name="ex_2.39" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.39">Exercise 2.39 </a></b> 
  
    
     
      
    The
    
      <span style="color:green"><kbd>accumulate</kbd></span>
      <span style="color:blue"><kbd>accumulate</kbd></span>
    
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    is also known as
    
      <span style="color:green">
      <kbd>fold-right</kbd>,</span>
      <span style="color:blue"><kbd>fold_right</kbd>,</span>
    
    because it combines the first element of the sequence with the result
    of combining all the elements to the right.  There is also a
    
      <span style="color:green"><kbd>fold-left</kbd>,</span>
      <span style="color:blue"><kbd>fold_left</kbd>,</span>
    
    which is similar to
    
      <span style="color:green"><kbd>fold-right</kbd>,</span>
      <span style="color:blue"><kbd>fold_right</kbd>,</span>
    
    except that it combines elements working in the opposite direction:
     
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_30_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (fold-left op initial sequence)
  (define (iter result rest)
    (if (null? rest)
      result
      (iter (op result (car rest))
            (cdr rest))))
  (iter initial sequence))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_30_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQ8qAbAEwH0GBTPMgCioAcANKApEKlAIYMhAZ3YBHAu1LsAlKADe2UNrrFy1WmPYAnbsfbSCDMkPPSyazTuehzZAscPSWRKwzMWDlouIToA-K4WVmTBoSEAXMJkJrx8AZbWQgAW7OJM6Q4qQrFxpdpk4hT+doUA3CUAviVuHobJpiJiFJIy8orKKvVN+IysHFzcDBT2Qr4MUqBT9twAjEIoQpgqg0A')">function fold_left(op, initial, sequence) {
    function iter(result, rest) {
        return is_null(rest)
               ? result
               : iter(op(result, head(rest)), 
                      tail(rest));
    }
    return iter(initial, sequence);
}
</pre></div></div></td></tr></table>
    
    What are the values of
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_31_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(fold-right / 1 (list 1 2 3))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_31_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChslAM4CGAtgKahEGUDGNArifQDZEAuZ2NA9gHYFtQAM27MAJgH0ATgEsA5gAtBAXloMmrDgG5cQ+rxpsZfUGJkA3GWLIAKAB4AaUAE8AlKADe2UD9BSybPRSvKB2oGDOOgC+uqKSsopsNmaW1k4AjE7MMgI2mahOmK6uWkA')">fold_right(divide, 1, list(1, 2, 3));
</pre></div></div></td></tr></table>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_32_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(fold-left / 1 (list 1 2 3))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_32_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQ8qAbAEwH0GBTPMgCioAcANKApEKlAIYMhAZ3YBHAu1LsAlKADe2UNrrFy1WmPYAnbsfbSCDMkPPSyazTuehzZAscPSWRKwzMWDlouIToA-K4WVmTBoSEAXMJkJrx8AZbWQgAW7OJM6Q4qQrFxpdpk4hT+doUA3CUAviVuHobJpiJiFJIy8orKKvVN+HqUNKBMFABuFEzs3AAeQgCejs3s7p6gC6Bgy0O49MxsnDyTM3NCAIxCDBT23DeoQpgqg0A')">fold_left(divide, 1, list(1, 2, 3));
</pre></div></div></td></tr></table>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_33_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(fold-right list nil (list 1 2 3))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_33_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChslAM4CGAtgKahEGUDGNArifQDZEAuZ2NA9gHYFtQAM27MAJgH0ATgEsA5gAtBAXloMmrDgG5cI8dPlKAFMxkCANKF4tml0wKMBGSykuYAlO61A')">fold_right(list, null, list(1, 2, 3));
</pre></div></div></td></tr></table>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_34_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(fold-left list nil (list 1 2 3))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_34_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQ8qAbAEwH0GBTPMgCioAcANKApEKlAIYMhAZ3YBHAu1LsAlKADe2UNrrFy1WmPYAnbsfbSCDMkPPSyazTuehzZAscPSWRKwzMWDlouIToA-K4WVmTBoSEAXMJkJrx8AZbWQgAW7OJM6Q4qQrFxpdpk4hT+doUA3CUAviVuHobJpiJiFJIy8orKKvVN+IysHFzcDBT2Qr4MUqBT9twAjEIoQpgqg0A')">fold_left(list, null, list(1, 2, 3));
</pre></div></div></td></tr></table>
    Give a property that
    
      <span style="color:green"><kbd>op</kbd></span>
      <span style="color:blue"><kbd>op</kbd></span>
    
    should satisfy to guarantee that
    
      <span style="color:green"><kbd>fold-right</kbd></span>
      <span style="color:blue"><kbd>fold_right</kbd></span>
    
    and
    
      <span style="color:green"><kbd>fold-left</kbd></span>
      <span style="color:blue"><kbd>fold_left</kbd></span>
    
    will produce the same values for any sequence.
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_35_6_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_35_6_div"><SOLUTION>
    
      <OL type="a">
	<LI>
          <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_35_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_35_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChslAM4CGAtgKahEGUDGNArifQDZEAuZ2NA9gHYFtQAM27MAJgH0ATgEsA5gAtBAXloMmrDgG5cQ+rxpsZfUGJkA3GWLIAKAB4AaUAE8AlKADe2UD9BSybPRSvKB2oGDOOgC+uqKSsopsNmaW1k4AjE7MMgI2mahOmK6uOnhg-gQsbABcoOloAKxAA')">1.5
</pre></div></div></td></tr></table>
	</LI>
	<LI>
          <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_36_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_36_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQ8qAbAEwH0GBTPMgCioAcANKApEKlAIYMhAZ3YBHAu1LsAlKADe2UNrrFy1WmPYAnbsfbSCDMkPPSyazTuehzZAscPSWRKwzMWDlouIToA-K4WVmTBoSEAXMJkJrx8AZbWQgAW7OJM6Q4qQrFxpdpk4hT+doUA3CUAviVuHobJpiJiFJIy8orKKvVN+HqUNKBMFABuFEzs3AAeQgCejs3s7p6gC6Bgy0O49MxsnDyTM3NCAIxCDBT23DeoQpgqg7ggkRlkiQAMaFcAGzAkGgsGAoA')">0.16666666666666666
</pre></div></div></td></tr></table>
	</LI>
	<LI>
          <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_37_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_37_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChslAM4CGAtgKahEGUDGNArifQDZEAuZ2NA9gHYFtQAM27MAJgH0ATgEsA5gAtBAXloMmrDgG5cI8dPlKAFMxkCANKF4tml0wKMBGSykuYAlO514wUsgRY2AC5QAG1nMNDXSMxLUOtmWysbAF0UywTmNIzUlKA')">[1, [[2, [[3, [null, null]], null]], null]]
</pre></div></div></td></tr></table>
	</LI>
	<LI>
          <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_38_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_38_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQ8qAbAEwH0GBTPMgCioAcANKApEKlAIYMhAZ3YBHAu1LsAlKADe2UNrrFy1WmPYAnbsfbSCDMkPPSyazTuehzZAscPSWRKwzMWDlouIToA-K4WVmTBoSEAXMJkJrx8AZbWQgAW7OJM6Q4qQrFxpdpk4hT+doUA3CUAviVuHobJpiJiFJIy8orKKvVN+IysHFzcDBT2Qr4MUqBT9twAjEIoQpgqg7ggkRlkiQDaJ3MLR2ugZwC610JHG1d+t-eYs8-XQA')">[[[null, [1, null]], [2, null]], [3, null]]
</pre></div></div></td></tr></table>
	</LI>
      </OL>
      We can guarantee that <kbd>fold_right</kbd>
      and <kbd>fold_left</kbd> produce
      the same values for any sequence, if we require that
      <kbd>op</kbd> is commutative and associative.
      They also produce the same values, if
      <kbd>op</kbd> is just associative and the
      argument <kbd>initial</kbd> is a left and right
      neutral element with respect to <kbd>op</kbd>.
      <div class='snippet' id='javascript_35_39_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQAHAGwIGcAKADwBpQBPASlABvbKFGgATgFMyBcbXagA1LwDc2AL64QoZgEMAtpNC7mxkiQL6CDXWUnYSNZmVB4qDACYB9cRQDmABYuALxmFlY2dmr47t6+gWSsjCzcAAzcDBTOrACM3CjcmHx8KkA')">fold_right(plus, 0, list(1, 2, 3));
</pre></div></div>
      <div class='snippet' id='javascript_35_40_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQAHAGwIGcAKADwBpQBPASlABvbKFGgATgFMyBcbXagA1LwDc2AL65CpSjVB4qDACYB9BpLxlWVOtwpEKlAIYNuzSQEcCk0pIHCxfWJyalpHSXFWKWYCBjJuaLJ-EUCxKRk5UApmEyJYhijJZiSU1LLRAH4JItiyUvLUgC4ssgjrOkKYuO4AC0knI06kvm56hvHQMicKAsS+PjVAzUD02TDWyPtHChc3T29fBY0tQ1NzS1ZGFm4ABm4GbKsARm4Ubkx5lSA')">fold_left(plus, 0, list(1, 2, 3));
</pre></div></div>
    </SOLUTION></div></div>
</EXERCISE></div>


  
    <div class="permalink">
    <a name="ex_2.40" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.40">Exercise 2.40 </a></b> 
  
    Complete the following definitions of <kbd>reverse</kbd>
     
    (exercise&nbsp;<REF NAME="ex:reverse"><a class="superscript" id="2.2.3-ex-link-2.18" href="./2.2.1.html#ex_2.18">2.18</a></REF>) in terms of
    
      <span style="color:green"><kbd>fold-right</kbd></span>
      <span style="color:blue"><kbd>fold_right</kbd></span>
    
    and
    
      <span style="color:green"><kbd>fold-left</kbd></span>
      <span style="color:blue"><kbd>fold_left</kbd></span>
    
    from exercise&nbsp;<REF NAME="ex:fold-right-left"><a class="superscript" id="2.2.3-ex-link-2.39" href="./2.2.3.html#ex_2.39">2.39</a></REF>:
    <kbd class='snippet'>
function reverse(sequence) {
    return fold_right((x, y) => $\langle{}$<EM>??</EM>$\rangle$, null, sequence);
}
      </kbd>
    <kbd class='snippet'>
function reverse(sequence) {
    return fold_left((x, y) => $\langle{}$<EM>??</EM>$\rangle$, null, sequence);
}
      </kbd>
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_35_7_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_35_7_div"><SOLUTION>
    
      <div class='snippet' id='javascript_35_41_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsCcBTANwLwGcCAKAGwEsyAXSgRgBpQAWdgVnYE52zAGzsU3AJTiA3EA')">reverse(list(1, 4, 5, 9, 16, 25));
</pre></div></div>
      <div class='snippet' id='javascript_35_42_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChslAM4CGAtgKahEGUDGNArifQDZEAuZ2NA9gHYFtQAM27MAJgH0ATgEsA5gAtBAXloMmrDgG5cQ+rxpsZfUFLIA3MlIJkAFDYCO9MgbIBKUAG9soX6bJs9FK8wqKSsopstrYAHgA0oACeHsoAfJQADhkuYraJCcwyArFubgk+fpVV1X68LMwJjs6ubjoAvrhmltZ2hcUAjAkALAkArAkAnAn9AGwJKKOlWkA')">function reverse(sequence) {
    return fold_right((x, y) => append(y, list(x)), 
                      null, sequence);
}
</pre></div></div>
      <div class='snippet' id='javascript_35_43_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQ8qAbAEwH0GBTPMgCioAcANKApEKlAIYMhAZ3YBHAu1LsAlKADe2UNrrFy1WmPYAnbsfbSCDMkPPSyazTuehzZAscPSWRKwzMWDlouIToA-K4WVmTBoSEAXMJkJrx8AZbWQgAW7OJM6Q4qQrFxpdpk4hT+doUA3CUAviVuHobJpiJiFJIy8orKKvVN+HqUNJEAbiay3LIKSiSqGs3s7p50jKwcXNzcAB5CAJ5qALwAfKB8laaHQntFoL4MUqBz-YuD2MPmU8YzDBR7NwAIxCAAsQgArEIAJxCYEANiEKEhKkGQA')">function reverse(sequence) {
    return fold_left((x, y) => pair(y, x), null, sequence);
}
</pre></div></div>
    </SOLUTION></div></div>
</EXERCISE></div>


  

  
      <div class='permalink'>
        <a name='h2' class='permalink'></a><h2>
    
    Nested Mappings
  </h2></div>

  
  

  <div class='permalink'>
<a name='p21' class='permalink'></a><p>
    We can extend the sequence paradigm to include many computations that are
    commonly expressed using nested loops.<a class='superscript' id='footnote-link-5' href='#footnote-5'>[5]</a>
    Consider this problem: Given a positive integer
    $n$, find all ordered pairs of distinct positive
    integers $i$ and $j$,
    where $1\leq j < i\leq n$, such that
    $i +j$ is prime.  For example, if
    $n$ is 6, then the pairs are the following:
    
      \[
      \begin{array}{c|ccccccc}
      i     & 2 & 3 & 4 & 4 & 5 & 6 & 6 \\
      j     & 1 & 2 & 1 & 3 & 2 & 1 & 5 \\
      \hline
      i+j   & 3 & 5 & 5 & 7 & 7 & 7 & 11
      \end{array}
      \]
    
    A natural way to organize this computation is to generate the sequence
    of all ordered pairs of positive integers less than or equal to
    $n$, filter to select those pairs whose sum is
    prime, and then, for each pair $(i, j)$ that
    passes through the filter, produce the triple
    $(i, j, i+j)$.
  </p></div>

  <div class='permalink'>
<a name='p22' class='permalink'></a><p>
    Here is a way to generate the sequence of pairs: For each integer
    $i\leq n$, enumerate the integers
    $j < i$, and for each such
    $i$ and $j$
    generate the pair $(i, j)$.  In terms of
    sequence operations, we map along the sequence
    
      <span style="color:green"><kbd>(enumerate-interval 1 n)</kbd>.</span>
      <span style="color:blue"><kbd>enumerate_interval(1, n)</kbd>.
      </span>
    
    For each $i$ in this sequence, we map along the
    sequence
    
      <span style="color:green"><kbd>(enumerate-interval 1 (- i 1))</kbd>.
      </span>
      <span style="color:blue">
	<kbd>enumerate_interval(1, i - 1)</kbd>.
      </span>
    
    For each $j$ in this latter sequence, we
    generate the pair
    
      <span style="color:green"><kbd>(list i j)</kbd>.</span>
      <span style="color:blue"><kbd>list(i, j)</kbd>.</span>
    
    This gives us a sequence of pairs for each $i$.
    Combining all the sequences for all the $i$ (by
    accumulating with <kbd>append</kbd>) produces the
    required sequence of pairs:<a class='superscript' id='footnote-link-6' href='#footnote-6'>[6]</a>
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_44_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
;; replace n below by the desired number
(accumulate append
  nil
  (map (lambda (i)
         (map (lambda (j) (list i j))
              (enumerate-interval 1 (- i 1))))
       (enumerate-interval 1 n)))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_44_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBTIggWzoCcBDMugfQqK9YA3dgBsAFCKoB3ADSgAFhQDm8gJSgA3tlA7QrOmQKtakqaAB8C5fO267ugPyhGIkbft2AXKAAO7CqwS0jLuHmE6DMxsnDx8AsLipqAA1KAAjHKKKqqqANzYAL64JDQAzmTOoAC8oABs+djsJCTMBCIxYuw+PgwAJnKhYS4iA+G6TF1iFNWWEz5iAFYzoCIU5VNyC6ohY7v2kSwcXLz8bAliGaDTALTpOTt7ugfRx3FnohdyRDl5QA')">accumulate(append, 
           null, 
           map(i => map(j => list(i, j),
                        enumerate_interval(1, i - 1)),
               enumerate_interval(1, n)));
</pre></div></div></td></tr></table>
    The combination of mapping and accumulating with
    <kbd>append</kbd> is so common in this sort of program
    that we will isolate it as a separate
    
      <span style="color:green">procedure:</span>
      <span style="color:blue">function:</span>
      
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_45_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (flatmap proc seq)
  (accumulate append nil (map proc seq)))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_45_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQ8AbAQzIFtGAHACjwBpQBnAKYBHAJSgA3tlAzQAJ0FkCc2oxIkCLAkzKDOHdoKIATPkW30+bLrwEjRogNzYAvrgbNrnAB6gAvAB8oPQU-GQ+fN6ifCFhnACMfCh8mHwALA6OQA')">function flatmap(f, seq) {
    return accumulate(append, null, map(f, seq));
}
</pre></div></div></td></tr></table>
    
    Now filter this sequence of pairs to find those whose sum is prime. The
    filter predicate is called for each element of the sequence; its argument
    is a pair and it must extract the integers from the pair. Thus, the
    predicate to apply to each element in the sequence is
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_46_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (prime-sum? pair)
  (prime? (+ (car pair) (cadr pair))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_46_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBnARwIEMAnAUwAoAPASlADe2UCNAcyBVrW6gAVKG4BubAF9chUpRr0AtswA2+9nTIB9ACYUAbhTpVWnIvyGix7CVNB4KRcxeu29o4ANKi8ymoa5NS03r7+NnYORKFkxmaWifbOwqLikrSMLBycaSYJgaz8AHygRLmujQD8dQ2NogBcoJkU5sal6RVJoU5t7aAtZRkBSWPtXXF+PUkhoFND9qAA1KAAjOGq+MTR2j19dJzMoQBGOa75ntegAKSgzKAAvF+gAAwR6sctLRbKYAA6sCg6LhOQRtB60WhfD66AxGcrLIJOf5HTQxUAg8GQ9imOgEHScUHMChVWH3dwFfF0MEQqGcAAW7GY5gpVJpOw5XNKVP0POpvHF2IJLOJpPJ+lsZE4AA5QgBOCVAA')">function is_prime_sum(pair) {
    return is_prime(head(pair) + head(tail(pair)));
}
</pre></div></div></td></tr></table>
    
    Finally, generate the sequence of results by mapping over the filtered
    pairs using the following
    
      <span style="color:green">procedure,</span>
      <span style="color:blue">function,</span>
    
    which constructs a triple consisting of the two elements of the pair along
    with their sum:
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_47_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (make-pair-sum pair)
  (list (car pair) (cadr pair) (+ (car pair) (cadr pair))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_47_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBbAQwGsBTAfQAcGKAnNgZwJ0AFF14BKUAG9soOaB4syBHrQA2FfmWEALFgwAmo7j3EAaUHsPCy3NcYnnQs+a7fyrRsadABqS-pGthT23uLhANzYAL64jKycJgJCwhpawgAcFgCckUA')">function make_pair_sum(pair) {
    return list(head(pair), head(tail(pair)), 
                head(pair) + head(tail(pair)));
}
</pre></div></div></td></tr></table>
    
    Combining all these steps yields the complete
    
      <span style="color:green">procedure:</span>
      <span style="color:blue">function:</span>
    
     
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_48_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (prime-sum-pairs n)
  (map make-pair-sum
       (filter prime-sum?
               (flatmap
                 (lambda (i)
                   (map (lambda (j) (list i j))
                        (enumerate-interval 1 (- i 1))))
                 (enumerate-interval 1 n)))))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_48_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBbAQwGsBTAfQAcGKAnNgZwJ0AFF14BKUAG9soOaB4syBHrQA2FfmWEALFgwAmo7j3EAaUHsPCy3NcYnnQs+a7fyrRsadABqS-pGthT23uLhANzYAL64hKSUNKD8AI4EDIrCAB6SMq6KyqqgWaAAVMVRsfjE5NS0-IxqaixabAYUAG6aVDzCRLkucgUqtHgURAZtnd29RBYo4pXVCXWgYxNTXfw9fRZkLWSbMwP5SiPJaRksNgdH2z4AfKBEg+5yAPzPr28AXKDtXQMLRurQBMws-W+7k++1B03uULcf3WkzB912oFhhzRPT8oAAjIsYstakkwUD+MIGBYAEYneTDIo00AAUlADFAAF5uaAAAxLEmJWiaTg8Ch0a79aSvRm0WjcznJRrNOFbHb9AXxUnC-ii8XsQQiMLS06FHV6iW6QIOHz+Tw2Ow28JEqpaoVrNQMMiMDjCPAWfgsFL0oZnIoMEgkIQET37KkcDgsCYQmNqCw+v0BoORYmC1ZJoQsHhe9jjfY8DoMexqKgAdwsOgoAHMdCGFGH1HXQE9Gy3Ea5PkRU-35H9vMIa-WR285AWJcX9mwy0XK9Wu-58Q3m62XXEau6OGKJQIhJwTJSpXkGR36AxfYxWGfeCe6BZp24xmpy8IRYf9S+3xnIC5DwWMMwoLkngzAArSDQA0LQfwsaCnHfYD0NcOcixLJciHLVdhE3UAIIAWgJcIzDQjD5CwhdSzwlcq0IiFnV3bA-2PQ0nx4SkADZFiAA')">function prime_sum_pairs(n) {
    return map(make_pair_sum, 
               filter(is_prime_sum, 
                   flatmap(i => map(j => list(i, j), 
                                    enumerate_interval(1, i - 1)),
                           enumerate_interval(1, n))));
}
</pre></div></div></td></tr></table>
    
  </p></div>

  <div class='permalink'>
<a name='p23' class='permalink'></a><p>
    Nested mappings are also useful for sequences other than those that
    enumerate intervals.  Suppose we wish to generate all the 
    
    
    permutations
    of a set $S$; that is, all the ways of ordering
    the items in the set.  For instance, the permutations of
    $\{1, 2, 3\}$ are
    $\{1, 2, 3\}$,
    $\{ 1, 3, 2\}$,
    $\{2, 1, 3\}$,
    $\{ 2, 3, 1\}$,
    $\{ 3, 1, 2\}$, and
    $\{ 3, 2, 1\}$.  Here is a plan for generating
    the permutations of&nbsp;$S$: For each item
    $x$ in $S$,
    recursively generate the sequence of permutations of
    $S-x$,<a class='superscript' id='footnote-link-7' href='#footnote-7'>[7]</a> and adjoin
    $x$ to the front of each one.  This yields, for
    each $x$ in $S$, the
    sequence of permutations of $S$ that begin
    with&nbsp;$x$.  Combining these sequences for
    all $x$ gives all the permutations
    of&nbsp;$S$:<a class='superscript' id='footnote-link-8' href='#footnote-8'>[8]</a>
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_49_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (permutations s)
  (if (null? s)             ; empty set?
    (list nil)              ; sequence containing empty set
    (flatmap (lambda (x)
               (map (lambda (p) (cons x p))
                    (permutations (remove x s))))
             s)))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_49_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQ8AbAQzIFtGAHACjwBpQBnAKYBHAJSgA3tlAzQAJ0FkCc2oxIkCLAkzKDOHdoKIATPkW30+bLrwEjRogNzYAvrkKlKNUIblayzNRE-Jz84lKy8orKtBT8APrm9PSh4pHpsiCggizsZACedmQA-NIZkcWg9HFknEn0aeUyWULCBEYkgqAkNAEURP0A5tm5BUVlTaAAXHQ61pwAHqAAvAB8oPPsK+vsjBRyi3zsojwTk+dNvv6BNCEKLFQAbnoLfGEOpxfnYc5u2FcEAJeYKcar8WoARj4KD4mAcjiAA')">function permutations(s) {
    return is_null(s)             // empty set?
           ? list(null)           // sequence containing empty set
           : flatmap(x => map(p => pair(x, p),
                              permutations(remove(x, s))),
                     s);
}
</pre></div></div></td></tr></table>
    
    Notice how this strategy reduces the problem of generating permutations of
    $S$ to the problem of generating the
    permutations of sets with fewer elements than
    $S$.  In the terminal case, we work our way down
    to the empty list, which represents a set of no elements. For this, we
    generate
    
      <span style="color:green"><kbd>(list nil)</kbd>,</span>
      <span style="color:blue"><kbd>list(null)</kbd>,</span>
    
    which is a sequence with one item, namely the set with no elements.  The
    
      <span style="color:green"><kbd>remove</kbd></span>
      <span style="color:blue"><kbd>remove</kbd></span>
    
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    used in <kbd>permutations</kbd> returns all the items in
    a given sequence except for a given item.  This can be expressed as a
    simple filter:
     
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_50_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (remove item sequence)
  (filter (lambda (x) (not (= x item)))
          sequence))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_50_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQAnAUwFsqA3BgCgrOYBpQAzgwCOBBqQYBKUAG9soBfQZkCdWngoAbHnQ4APUAF4AfKACEofUcOHQ3ZpN7zFL166GjxJKQG5sAX1xNcQBzMgALDkYWdg5Mfk0KATIOAEZ+FH540AAWfgBWSSKfIA')">function remove(item, sequence) {
    return filter(x => ! (x === item),
                  sequence);
}
</pre></div></div></td></tr></table>
    
  </p></div>

  
    <div class="permalink">
    <a name="ex_2.41" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.41">Exercise 2.41 </a></b> 
  
    Write a
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
      
    
      <span style="color:green"><kbd>unique-pairs</kbd></span>
      <span style="color:blue"><kbd>unique_pairs</kbd>
      </span>
    
    that, given an integer $n$, generates the
    sequence of pairs $(i, j)$ with
    $1\leq j < i\leq n$.  Use
    
      <span style="color:green"><kbd>unique-pairs</kbd></span>
      <span style="color:blue"><kbd>unique_pairs</kbd>
      </span>
    
    to simplify the definition of
    
      <span style="color:green"><kbd>prime-sum-pairs</kbd></span>
      <span style="color:blue"><kbd>prime_sum_pairs</kbd>
      </span>
    
    given above.
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_35_8_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_35_8_div"><SOLUTION>
    
      <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_51_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_51_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBTIggWzoCcBDMugfQqK9YA3dgBsAFCKoB3ADSgAFhQDm8gJSgA3tlA7QrOmQKtakqaAB8C5fO267ugPyhGIkbft2AXKAAO7CqwS0jLuHmE6DMxsnDx8AsLipqAA1KAAjHKKKqqqANzYAL64hKSUNKBM7ADWPH4B3ADOzGJ1rOpadvqGxqAiFA1kYvJ07AAmLf5tmSPjZP7irTlyoeF2w2MTAeqp67Pzm205+UX4xOTUtA0AjgTs+mIAHu2hXUa0D6AAVKAPx8VnZUulVcdAG3FGFEE-SogSIz06BjeoDwfFG4Mh0NhchQeUKp1KF2RqPRUIaMLERDkXDBENJMPhulePWut3u1LIJMx6ksRBWHicvNWOm8tIoo1BYnZnLJrDkcL59icUtFMoVXiJRDRKvJlNAyoxMpS6VxRRK53KovFDTE7DkACMGTombQ7aAAKSgdigAC8vtAAAY-vjzbR+twfKwKCwKY69IierRfd7QA1gSJQRztbCTf8CeUwxGozwmkwDrHnaAC5Ho7sy0ba3MKAtJjkc8HAciRJxKj4xHg5A06Fdy-HaOwSCRmAQu1wbT4fAxRnLpyI5D2+wOh0c8e3CcQKDdapNrXDNC9R53u+xexQfZZ1wArO+9fqDChyB+qZZCn9hSIsDguF4fg2ASMQMkrUAAFpjS-UA1R-f9oiAuJQNEcC5W3U0AUJQsWEaZhw2PGMzwRbpaHXSoaiI+oS2-X8dBREQBDEKsiwIph6IYsJ90PGjWBPVsgzw4tCNaa0ADY8iAA')">function unique_pairs(n) {
    return flatmap(i => map(j => list(i, j), 
                            enumerate_interval(1, i - 1)), 
                   enumerate_interval(1, n));
}
function prime_sum_pairs(n) {
    return map(make_pair_sum, 
               filter(is_prime_sum, 
                      unique_pairs(n)));
}
</pre></div></div></td></tr></table>
      
    </SOLUTION></div></div>
</EXERCISE></div>


  
    <div class="permalink">
    <a name="ex_2.42" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.42">Exercise 2.42 </a></b> 
  
    Write a
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    to find all ordered triples of distinct positive integers
    $i$, $j$,
    and&nbsp;$k$ less than or equal to a given
    integer $n$ that sum to a given integer
    $s$.
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_35_9_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_35_9_div"><SOLUTION>
    
      <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_52_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_52_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBTIggWzoCcBDMugfQqK9YA3dgBsAFCKoB3ADSgAFhQDm8gJSgA3tlA7QrOmQKtakqaAB8C5fO267ugPyhGIkbft2AXKAAO7CqwS0jLuHmE6DMxsnDx8AsLipqAA1KAAjHKKKqqqANzYAL64hKSUNKB4IpxM7D5ieHIAznQAjupadvqGxqDsJCTMBFVcYrU+DAAmci4icjV1DaDNbXmFxcTk1LTEFC0EPGSsFD4idI1iRO2hXUa0ldW1YhSgALyW92TzYgBWr5ZfAGs-qARBRGmQnnJvnIAaoQuEEYikbpIiwOFxePw2AkxBlQL8ALTpHLw5Fkjyo6IYuLY0S4uTPIlpEmhcn0RhomKY+J0vGXVZFEqbconAjnAAecgAnldOgZbqBxSlQFL8oKNmVaIdjqdGtwyPJONxGsx9VQxI1prLdDcengKCIBE8uExGsC+gMmEMYmJRZbQAAGBkuxrqF7hpaktmgHZ7A5HE5nC45NW4bWJvUGo0mphm3FB0AANjyQA')">function unique_triples(n) {
    return flatmap(i => flatmap(j => map(k => list(i, j, k),
                                         enumerate_interval(1, j - 1)),
                                enumerate_interval(1, i - 1)),
                   enumerate_interval(1, n));
}
function plus(x, y) {
    return x + y;
}
function triples_that_sum_to(s, n) {
    return filter(items => accumulate(plus, 0, items) === s,
                  unique_triples(n));
}
</pre></div></div></td></tr></table>
      
    </SOLUTION></div></div>
</EXERCISE></div>

      
	
	
      
    <FIGURE>
      <img class="scale_factor_" id="fig_2.15" src="../img_original/ch2-Z-G-23.svg">
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./2.2.3.html#fig_2.15">Figure 2.15 </a></b>A solution to the eight-queens puzzle.
	</div>
    </FIGURE>
  
  
    <div class="permalink">
    <a name="ex_2.43" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.43">Exercise 2.43 </a></b> 
  
      
      The 
      
      
      
      <QUOTE>eight-queens puzzle</QUOTE> asks how to place eight queens on a
      chessboard so that no queen is in check from any other (i.e., no two
      queens are in the same row, column, or diagonal).  One possible solution
      is shown in figure&nbsp;<REF NAME="fig:8queens"><a class="superscript" id="2.2.3-fig-link-2.15" href="./2.2.3.html#fig_2.15">2.15</a></REF>.  One way to solve the
      puzzle is to work across the board, placing a queen in each column.
      Once we have placed $k-1$ queens, we must place
      the $k$th queen in a position where it does not
      check any of the queens already on the board.  We can formulate this
      approach recursively: Assume that we have already generated the sequence
      of all possible ways to place $k-1$ queens in
      the first $k-1$ columns of the board.  For
      each of these ways, generate an extended set of positions by placing a
      queen in each row of the $k$th column.  Now
      filter these, keeping only the positions for which the queen in the
      $k$th column is safe with respect to the other
      queens.  This produces the sequence of all ways to place
      $k$ queens in the first
      $k$ columns.  By continuing this process, we
      will produce not only one solution, but all solutions to the puzzle.
      <div class='permalink'>
<a name='p24' class='permalink'></a><p>
      We implement this solution as a
      
	<span style="color:green">procedure</span>
      <span style="color:blue">function</span>
      
	<span style="color:green"><kbd>queens</kbd>,</span>
	<span style="color:blue"><kbd>queens</kbd>,</span>
      
      which returns a sequence of all solutions to the problem of placing
      $n$ queens on an
      $n\times n$ chessboard.
      
	<span style="color:green"><kbd>Queens</kbd></span>
	<span style="color:blue">The function <kbd>queens</kbd>
	</span>
      
      has an internal
      
	<span style="color:green">procedure</span>
	<span style="color:blue">function</span>
      
      
	<span style="color:green"><kbd>queen-cols</kbd></span>
	<span style="color:blue"><kbd>queens_cols</kbd>
	</span>
      
      that returns the sequence of all ways to place queens in the first
      $k$ columns of the board.
    
      
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_53_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(define (queens board-size)
  (define (queen-cols k)
    (if (= k 0)
      (list empty-board)
      (filter
        (lambda (positions) (safe? k positions))
        (flatmap
          (lambda (rest-of-queens)
            (map (lambda (new-row)
                   (adjoin-position new-row k rest-of-queens))
                 (enumerate-interval 1 board-size)))
          (queen-cols (- k 1))))))
  (queen-cols board-size))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_53_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQ8AbAQzIFtGAHACjwBpQBnAKYBHAJSgA3tlAzQAJ0FkCc2oxIkCLAkzKDOHdoKIATPkW30+bLrwEjRogNzYAvrkKlKNUEc2C5zIIA+hREunIAboz0nPRUAO58ABYUAOZJ4lKy8orKtHHxoAB8oCnp0tmVoAD8oOb09BVVsgBcoOyMFHKxCTxNzQO+LP6BIWH+UTEFoADUoACMyWkZTq7uxOTUtMIEgkb8nABGVIxyxkH8FABegpn9HpveO3tEQSRU9AcA1ncDCkoqUBfUAAXjBoAADP0BrJavQKPwyJxBCx2GQAJ5BY6nYyiaEw0BtPAUejhTj4gmydhUS5eIj8UElBEXRh4PRfPjU2lbfiiPgUyl0HTWTgKRFBKh4ILPfaM0ACwUwkVEQTxIJyBJyhWKxWMYwAKyooSCXIodM4KrVGsSQL6OvtDqqYrIEqlMvpfPljodQxGujG4UmnEWoGxZwu11ufO1jvdbw+31AAFoFg5VrI3LJ-nlQHH3p8jidw5cbqs3Nh3QcABxOIA')">function queens(board_size) {
    function queen_cols(k) {
        return k === 0
               ? list(empty_board)
               : filter(
                   positions => is_safe(k, positions), 
                   flatmap(rest_of_queens => 
                             map(new_row => 
                                   adjoin_position(new_row, k,
                                                   rest_of_queens), 
                                 enumerate_interval(1, board_size)),
                           queen_cols(k - 1)));
   }
   return queen_cols(board_size);
}
</pre></div></div></td></tr></table>
    In this
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    
      <span style="color:green"><kbd>rest-of-queens</kbd></span>
      <span style="color:blue"><kbd>rest_of_queens</kbd>
      </span>
    
    is a way to place $k-1$ queens in the first
    $k-1$ columns, and
    
      <span style="color:green"><kbd>new-row</kbd></span>
      <span style="color:blue"><kbd>new_row</kbd></span>
    
    is a proposed row in which to place the queen for the
    $k$th column.  Complete the program by
    implementing the representation for sets of board positions, including the
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    
      <span style="color:green"><kbd>adjoin-position</kbd>,</span>
      <span style="color:blue"><kbd>adjoin_position</kbd>,
      </span>
    
    which adjoins a new row-column position to a set of positions, and
    
      <span style="color:green"><kbd>empty-board</kbd>,</span>
      <span style="color:blue"><kbd>empty_board</kbd>,
      </span>
    
    which represents an empty set of positions.  You must also write the
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    
      <span style="color:green"><kbd>safe?</kbd>,</span>
      <span style="color:blue"><kbd>is_safe</kbd>,</span>
    
    which determines for a set of positions, whether the queen in the
    $k$th column is safe with respect to the others.
    (Note that we need only check whether the new queen is safe—the
    other queens are already guaranteed safe with respect to each other.)
      </p></div>
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_35_10_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_35_10_div"><SOLUTION>
    
      <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_54_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_54_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBDAEwCsqKiB9AByoGcLKaACgBOVAO4AaUCSoAbKcICmPMgEpQAb2ygdoJWQLDanOhWGCTZkeKkzZqhcrUBubAF8gA')">function adjoin_position(row, col, rest) {
    return pair(pair(row, col), rest);
}
</pre></div></div></td></tr></table>
      <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_55_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_55_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsGMB7AOwGcAXUAUwFsAHMgTwH0AjAgQwCcATUAXlBEArgBsRAbiA')">const empty_board = null;
</pre></div></div></td></tr></table>
      <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_56_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_56_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQKBnAfXoEM8BTACgGsAaUAA5V6FSjXoBKUAG9soeaBLiyoPBQBO9Mo3VUA7qAC8oABbsWAE05nLnISLFFJEgNxyFSpyrWbtSgDZGoGQsFP7W5lb2otROEq7u8ursZATqtCwkJAQAtgT+LGRcdsL89FSMeCzqUoYAfDKJCs0trc2eWqC6BsY2UcIJbUPDisqjgcYhYSWSbiPzzcmp6aDlldWgAGSbTQt7Cj5aOvqgALSqGkcBoACEhoa7+3vdZ+NbO0+fF77HBgDU3yuVECdweXyeLwB122j3BQ0O2heoK6+jmcPkAF9eLCnmR1AR2PwcfspuFoo5nG4MUA')">function is_safe(k, positions) {
    const first_row = head(head(positions));
    const first_col = tail(head(positions));
    return accumulate((pos, so_far) => {
                         const row = head(pos);
                         const col = tail(pos);
                         return so_far &&
                                first_row - first_col !==
                                row - col &&
                                first_row + first_col !==
                                row + col &&
                                first_row !== row;
                      },
                      true, 
                      tail(positions));
}
</pre></div></div></td></tr></table>
      Putting it all together:
      <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_57_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_57_div'><div class='pre-prettyprint'><pre class='prettyprint eval' title='Evaluate Javascript program'onclick="window.open('http://source-academy.github.io/playground#chap=2&prgrm=PTAEGUEkGEAVQFLlAJgHToMwChsDMBXAOwGMAXASwHsjQBDAEwCsqKiB9AByoGcLKaACgBOVAO4AaUCSoAbKcICmPMgEpQAb2ygdoJWQLDanOhWGCTZkeKkzZqhcrUBubAF9cMoitCKAtpxkAJ7sAEZUdMIMoAC8oEQEsrKu+MTk1LQUPOw8dHiKggDWUtx8At7qWrrSND54ZirsomKxoAAWioyCHV2l-Bk8qqqu1V51DWTsdq1kprLdnQwWvP21QyO6+oa0dCQkBH6JdGQFyzxSPFTseJHqMQB8mtrVL69vOmNkeuKtPUulw2e72Br0+NVkMzmZ0BINh1S2RlAl2ukVAADI0UC4djqvVhI1mqAALSgPGNaYAQhiMSxOJxhJJ0wxtLpcLJk0JAGpSRMpnJQFSaazWVzwejMcK6eymj9Bd8xBtJTo3BIWayyMICIopGq6bMKPM+uVBoCPKlSOVSbJjn46JxBHgLooAI6VLEInZ7A5HE6CO2cRREBhSBJJKS2+2OpEu9buXCEC0ZXwJPyKYTHRTsNgnYQANzo81kNnaFAA5m03fDFAZEUWWo82mW2rrdAB+eKJWQtnQALlAlnMddVksDBzTGazRBz+cLP25AEYpI3y7GzQn0jRQM6tYGeIJwpEGDkKAAvRSV3Try3bxSBvmyPeFC+vD2gQqxamgAAM3Ze7dkWRkII-iBCEB5RKov7VH29SyDmghQW8RoDLEjxZDkeQFMU-YrMaDigIhrx4NaZARiITjsFQeDsDeu6oQRSogmRRCKGIMotA8DGMTijAsGwXC4RkggsWxzRSMUhHcSKFFUTRO4VDqUmwqOqbpick7TgWgiLqA4FHnwZ5DMOSm6LRHB2I+xKgPOQwwsqQKvmZ957npx6Ga4ZpmXuAAcgLYEAA')">// click here to see all solutions
</pre></div></div></td></tr></table>
    </SOLUTION></div></div>
</EXERCISE></div>


  
    <div class="permalink">
    <a name="ex_2.44" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_2.44">Exercise 2.44 </a></b> 
  
    Louis Reasoner is having a terrible time doing
    exercise&nbsp;<REF NAME="ex:8queens"><a class="superscript" id="2.2.3-ex-link-2.43" href="./2.2.3.html#ex_2.43">2.43</a></REF>.  His
    
      <span style="color:green"><kbd>queens</kbd></span>
      <span style="color:blue"><kbd>queens</kbd></span>
    
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    seems to work, but it runs extremely slowly. (Louis never does manage to
    wait long enough for it to solve even the
    $6\times 6$ case.)  When Louis asks Eva Lu Ator
    for help, she points out that he has interchanged the order of the nested
    mappings in the
    
      <span style="color:green"><kbd>flatmap</kbd>,</span>
      <span style="color:blue"><kbd>flatmap</kbd>,</span>
    
    writing it as
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td><div class='snippet' id='javascript_35_58_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
(flatmap
  (lambda (new-row)
    (map (lambda (rest-of-queens)
           (adjoin-position new-row k rest-of-queens))
         (queen-cols (- k 1))))
  (enumerate-interval 1 board-size))</pre></div></div>    </td>
            <td><div class='snippet' id='javascript_35_58_div'><div class='pre-prettyprint'><pre class='prettyprint no-eval'>
flatmap(new_row =>
          map(rest_of_queens => 
                adjoin_position(new_row, k, 
                                rest_of_queens), 
              queen_cols(k - 1)), 
        enumerate_interval(1, board_size));</pre></div></div></td></tr></table>
    Explain why this interchange makes the program run slowly.  Estimate
    how long it will take Louis's program to solve the eight-queens
    puzzle, assuming that the program in
    exercise&nbsp;<REF NAME="ex:8queens"><a class="superscript" id="2.2.3-ex-link-2.43" href="./2.2.3.html#ex_2.43">2.43</a></REF> solves the puzzle in time
    $T$.
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#solution_35_11_div" data-toggle="collapse">Solution</button></div>
      <div class="solution_content collapse" id="solution_35_11_div"><SOLUTION>
    
      Louis's program re-evaluates the application
      <kbd>queen_cols(k - 1))</kbd> in each iteration
      of <kbd>flatmap</kbd>, which happens
      $n$ times for each
      $k$. That means overall Louis's program will
      solve the puzzle in a time of about $n^n T$
      if the program in exercise&nbsp;<REF NAME="ex:8queens"><a class="superscript" id="2.2.3-ex-link-2.43" href="./2.2.3.html#ex_2.43">2.43</a></REF> solves the
      puzzle in time $T$.
    </SOLUTION></div></div>
</EXERCISE></div>

  
  
  
<hr>

    <div class='footnote'>
      <a class='footnote-number' id='footnote-1' href='#footnote-link-1' >[1] </a>
    <FOOTNOTE>
    This is, in fact,
    precisely the 
      
    
      <span style="color:green"><kbd>fringe</kbd></span>
      <span style="color:blue"><kbd>fringe</kbd></span>
    
    <span style="color:green">procedure</span>
    <span style="color:blue">function</span>
    
    from exercise&nbsp;<REF NAME="ex:fringe"><a class="superscript" id="2.2.3-ex-link-2.29" href="./2.2.2.html#ex_2.29">2.29</a></REF>.  Here we've renamed it
    to emphasize that it is part of a family of general sequence-manipulation
    
      <span style="color:green">procedures.</span>
      <span style="color:blue">functions.</span>
    
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-2' href='#footnote-link-2' >[2] </a>
    <FOOTNOTE>
    
    
    Richard Waters (1979) developed a program that automatically analyzes
    traditional 
    
    Fortran programs, viewing them in terms of maps, filters, and accumulations.
    He found that fully 90 percent of the code in the Fortran Scientific
    Subroutine Package fits neatly into this paradigm.  One of the reasons
    for the success of Lisp as a programming language is that lists provide a
    standard medium for expressing ordered collections so that they can be
    manipulated using higher-order operations. Many modern languages, such as
    Python, have learned this lesson.
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-3' href='#footnote-link-3' >[3] </a>
    <FOOTNOTE>
    According to 
    
    Knuth (1997b), this rule was formulated by
    
    W. G. Horner early in the nineteenth century, but the method was actually
    used by Newton over a hundred years earlier.  Horner's rule evaluates
    the polynomial using fewer additions and multiplications than does the
    straightforward method of first computing
    $a_{n} x^n$, then adding
    $a_{n-1}x^{n-1}$, and so on.  In fact, it is
    possible to prove that any algorithm for evaluating arbitrary polynomials
    must use at least as many additions and multiplications as does
    Horner's rule, and thus Horner's rule is an 
    
    
    optimal algorithm for polynomial evaluation.  This was proved (for the
    number of additions) by
    
    A. M. Ostrowski in a 1954 paper that essentially founded the modern study
    of optimal algorithms.  The analogous statement for multiplications was
    proved by 
    
    V. Y. Pan in 1966.  The book by 
    
    
    <CITATION>
      <div class='permalink'>
<a name='p25' class='permalink'></a><p>Borodin and Munro (1975)</p></div>
      Borodin and Munro 1975
    </CITATION> 
    provides an overview of these and other results about optimal
    algorithms.
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-4' href='#footnote-link-4' >[4] </a>
    <FOOTNOTE>
    This definition uses
    
      <span style="color:green">
	the extended version of <kbd>map</kbd>
	described in footnote&nbsp;<REF NAME="foot:generalmap"><a class="superscript" id="2.2.3-foot-link-8" href="./2.2.1.html#footnote-8">8</a></REF>.
      </span>
      <span style="color:blue">
	the function <kbd>accumulate_n</kbd>
	from exercise&nbsp;<REF NAME="ex:accumulate-n"><a class="superscript" id="2.2.3-ex-link-2.37" href="./2.2.3.html#ex_2.37">2.37</a></REF>.
      </span>
    
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-5' href='#footnote-link-5' >[5] </a>
    <FOOTNOTE>
    This approach to nested
    mappings was shown to us by 
    
    David Turner, whose languages 
    
    KRC and 
    
    Miranda provide elegant formalisms for dealing with these constructs.  The
    examples in this section (see also
    exercise&nbsp;<REF NAME="ex:8queens"><a class="superscript" id="2.2.3-ex-link-2.43" href="./2.2.3.html#ex_2.43">2.43</a></REF>) are adapted from Turner 1981.
    In section&nbsp;<REF NAME="sec:exploiting-streams"><a class="superscript" id="2.2.3-sec-link-3.5.3" href="./3.5.3.html">3.5.3</a></REF>, we'll see
    how this approach generalizes to infinite sequences.
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-6' href='#footnote-link-6' >[6] </a>
    <FOOTNOTE>
    We're representing a pair here
    as a list of two elements rather than as
    
      <span style="color:green">a Lisp pair.</span>
    <span style="color:blue">an ordinary pair.</span>
    Thus, the <QUOTE>pair</QUOTE> $(i, j)$ is
    represented as
    
      <span style="color:green"><kbd>(list i j)</kbd>,</span>
      <span style="color:blue"><kbd>list(i, j)</kbd>,</span>
    
    not
    
      <span style="color:green"><kbd>(cons i j)</kbd>.</span>
      <span style="color:blue"><kbd>pair(i, j)</kbd>.</span>
    
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-7' href='#footnote-link-7' >[7] </a>
    <FOOTNOTE>
    The set
    $S-x$ is the set of all elements of
    $S$, excluding
    $x$.
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-8' href='#footnote-link-8' >[8] </a>
    <FOOTNOTE>
    
    
    
    
    
    
      <span style="color:green">Semicolons in Scheme code are</span>
      <span style="color:blue">The character sequence <kbd>//</kbd>
      in JavaScript programs is</span>
    
    used to introduce <EM>comments</EM>. Everything from
    
      <span style="color:green">the semicolon</span>
      <span style="color:blue"><kbd>//</kbd></span>
    
    to the end of the line is ignored by the interpreter.  In this book we
    don't use many comments; we try to make our programs self-documenting
    by using descriptive names.
    </FOOTNOTE></div>
    
    
</div></div>

    <div class='nav'>
  
        <a class='btn btn-secondary btn-nav' href='./2.2.2.html'>&lt; Previous</a>
    
    <div style='flex-grow: 1;'></div>
  
        <a class='btn btn-secondary btn-nav' id='37' href='./2.2.4.html'>Next &gt;</a>
      </div>
    <div class='chapter_sign'>
      2.2.3&nbsp;&nbsp;
    Sequences as Conventional Interfaces
  
    </div>
    <script> var chapter_id = 36; </script>
    <script> var chapter_path = "chapters/2.2.3.html"; </script>
    <div class='next-page'></div>
    </div>
    </div> <!-- /.container -->
    </body></html>